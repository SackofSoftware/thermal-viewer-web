const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gif-D1HJ0RES.js","assets/index-B7YJMbYz.js","assets/index-BBkI-NZu.css","assets/jspdf.es.min--zgcPOXB.js","assets/ThreeView-Brc__CjD.js"])))=>i.map(i=>d[i]);
import{r as w,j as i,R as Ge,_ as Ft}from"./index-B7YJMbYz.js";var Ue=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},cn={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},un=class{#e=cn;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,t){return this.#e.setTimeout(e,t)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,t){return this.#e.setInterval(e,t)}clearInterval(e){this.#e.clearInterval(e)}},Se=new un;function dn(e){setTimeout(e,0)}var Te=typeof window>"u"||"Deno"in globalThis;function ue(){}function hn(e,t){return typeof e=="function"?e(t):e}function gt(e){return typeof e=="number"&&e>=0&&e!==1/0}function vs(e,t){return Math.max(e+(t||0)-Date.now(),0)}function we(e,t){return typeof e=="function"?e(t):e}function me(e,t){return typeof e=="function"?e(t):e}function _t(e,t){const{type:s="all",exact:n,fetchStatus:r,predicate:a,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==Rt(o,t.options))return!1}else if(!$e(t.queryKey,o))return!1}if(s!=="all"){const h=t.isActive();if(s==="active"&&!h||s==="inactive"&&h)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||r&&r!==t.state.fetchStatus||a&&!a(t))}function Lt(e,t){const{exact:s,status:n,predicate:r,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(s){if(Le(t.options.mutationKey)!==Le(a))return!1}else if(!$e(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||r&&!r(t))}function Rt(e,t){return(t?.queryKeyHashFn||Le)(e)}function Le(e){return JSON.stringify(e,(t,s)=>yt(s)?Object.keys(s).sort().reduce((n,r)=>(n[r]=s[r],n),{}):s)}function $e(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(s=>$e(e[s],t[s])):!1}var fn=Object.prototype.hasOwnProperty;function js(e,t,s=0){if(e===t)return e;if(s>500)return t;const n=$t(e)&&$t(t);if(!n&&!(yt(e)&&yt(t)))return t;const a=(n?e:Object.keys(e)).length,o=n?t:Object.keys(t),l=o.length,h=n?new Array(l):{};let u=0;for(let c=0;c<l;c++){const d=n?c:o[c],x=e[d],b=t[d];if(x===b){h[d]=x,(n?c<a:fn.call(e,d))&&u++;continue}if(x===null||b===null||typeof x!="object"||typeof b!="object"){h[d]=b;continue}const f=js(x,b,s+1);h[d]=f,f===x&&u++}return a===l&&u===a?e:h}function xt(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function $t(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function yt(e){if(!Ut(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!Ut(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Ut(e){return Object.prototype.toString.call(e)==="[object Object]"}function mn(e){return new Promise(t=>{Se.setTimeout(t,e)})}function bt(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?js(e,t):t}function pn(e,t,s=0){const n=[...e,t];return s&&n.length>s?n.slice(1):n}function gn(e,t,s=0){const n=[t,...e];return s&&n.length>s?n.slice(0,-1):n}var Et=Symbol();function Ss(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:!e.queryFn||e.queryFn===Et?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Cs(e,t){return typeof e=="function"?e(...t):!!e}function xn(e,t,s){let n=!1,r;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(r??=t(),n||(n=!0,r.aborted?s():r.addEventListener("abort",s,{once:!0})),r)}),e}var yn=class extends Ue{#e;#t;#s;constructor(){super(),this.#s=e=>{if(!Te&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#s=e,this.#t?.(),this.#t=e(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Ot=new yn;function wt(){let e,t;const s=new Promise((r,a)=>{e=r,t=a});s.status="pending",s.catch(()=>{});function n(r){Object.assign(s,r),delete s.resolve,delete s.reject}return s.resolve=r=>{n({status:"fulfilled",value:r}),e(r)},s.reject=r=>{n({status:"rejected",reason:r}),t(r)},s}var bn=dn;function wn(){let e=[],t=0,s=l=>{l()},n=l=>{l()},r=bn;const a=l=>{t?e.push(l):r(()=>{s(l)})},o=()=>{const l=e;e=[],l.length&&r(()=>{n(()=>{l.forEach(h=>{s(h)})})})};return{batch:l=>{let h;t++;try{h=l()}finally{t--,t||o()}return h},batchCalls:l=>(...h)=>{a(()=>{l(...h)})},schedule:a,setNotifyFunction:l=>{s=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{r=l}}}var ie=wn(),vn=class extends Ue{#e=!0;#t;#s;constructor(){super(),this.#s=e=>{if(!Te&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#s=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#e!==e&&(this.#e=e,this.listeners.forEach(s=>{s(e)}))}isOnline(){return this.#e}},st=new vn;function jn(e){return Math.min(1e3*2**e,3e4)}function Ns(e){return(e??"online")==="online"?st.isOnline():!0}var vt=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function Ts(e){let t=!1,s=0,n;const r=wt(),a=()=>r.status!=="pending",o=y=>{if(!a()){const p=new vt(y);x(p),e.onCancel?.(p)}},l=()=>{t=!0},h=()=>{t=!1},u=()=>Ot.isFocused()&&(e.networkMode==="always"||st.isOnline())&&e.canRun(),c=()=>Ns(e.networkMode)&&e.canRun(),d=y=>{a()||(n?.(),r.resolve(y))},x=y=>{a()||(n?.(),r.reject(y))},b=()=>new Promise(y=>{n=p=>{(a()||u())&&y(p)},e.onPause?.()}).then(()=>{n=void 0,a()||e.onContinue?.()}),f=()=>{if(a())return;let y;const p=s===0?e.initialPromise:void 0;try{y=p??e.fn()}catch(F){y=Promise.reject(F)}Promise.resolve(y).then(d).catch(F=>{if(a())return;const T=e.retry??(Te?0:3),j=e.retryDelay??jn,S=typeof j=="function"?j(s,F):j,P=T===!0||typeof T=="number"&&s<T||typeof T=="function"&&T(s,F);if(t||!P){x(F);return}s++,e.onFail?.(s,F),mn(S).then(()=>u()?void 0:b()).then(()=>{t?x(F):f()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(n?.(),r),cancelRetry:l,continueRetry:h,canStart:c,start:()=>(c()?f():b().then(f),r)}}var Fs=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),gt(this.gcTime)&&(this.#e=Se.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Te?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Se.clearTimeout(this.#e),this.#e=void 0)}},Sn=class extends Fs{#e;#t;#s;#r;#n;#o;#a;constructor(e){super(),this.#a=!1,this.#o=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#r=e.client,this.#s=this.#r.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=qt(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(e){if(this.options={...this.#o,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=qt(this.options);t.data!==void 0&&(this.setState(Bt(t.data,t.dataUpdatedAt)),this.#e=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#s.remove(this)}setData(e,t){const s=bt(this.state.data,e,this.options);return this.#i({data:s,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),s}setState(e,t){this.#i({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#n?.promise;return this.#n?.cancel(e),t?t.then(ue).catch(ue):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>me(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Et||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>we(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!vs(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#n&&(this.#a?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#s.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(e,t){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(e&&this.setOptions(e),!this.options.queryFn){const l=this.observers.find(h=>h.options.queryFn);l&&this.setOptions(l.options)}const s=new AbortController,n=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#a=!0,s.signal)})},r=()=>{const l=Ss(this.options,t),u=(()=>{const c={client:this.#r,queryKey:this.queryKey,meta:this.meta};return n(c),c})();return this.#a=!1,this.options.persister?this.options.persister(l,u,this):l(u)},o=(()=>{const l={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:r};return n(l),l})();this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#i({type:"fetch",meta:o.fetchOptions?.meta}),this.#n=Ts({initialPromise:t?.initialPromise,fn:o.fetchFn,onCancel:l=>{l instanceof vt&&l.revert&&this.setState({...this.#t,fetchStatus:"idle"}),s.abort()},onFail:(l,h)=>{this.#i({type:"failed",failureCount:l,error:h})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const l=await this.#n.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#s.config.onSuccess?.(l,this),this.#s.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof vt){if(l.silent)return this.#n.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#i({type:"error",error:l}),this.#s.config.onError?.(l,this),this.#s.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#i(e){const t=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...Rs(s.data,this.options),fetchMeta:e.meta??null};case"success":const n={...s,...Bt(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?n:void 0,n;case"error":const r=e.error;return{...s,error:r,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=t(this.state),ie.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),this.#s.notify({query:this,type:"updated",action:e})})}};function Rs(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ns(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Bt(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function qt(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=t!==void 0,n=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var Cn=class extends Ue{constructor(e,t){super(),this.options=t,this.#e=e,this.#i=null,this.#a=wt(),this.bindMethods(),this.setOptions(t)}#e;#t=void 0;#s=void 0;#r=void 0;#n;#o;#a;#i;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Ht(this.#t,this.options)?this.#d():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return jt(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return jt(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#w(),this.#v(),this.#t.removeObserver(this)}setOptions(e){const t=this.options,s=this.#t;if(this.options=this.#e.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof me(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#j(),this.#t.setOptions(this.options),t._defaulted&&!xt(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const n=this.hasListeners();n&&zt(this.#t,s,this.options,t)&&this.#d(),this.updateResult(),n&&(this.#t!==s||me(this.options.enabled,this.#t)!==me(t.enabled,this.#t)||we(this.options.staleTime,this.#t)!==we(t.staleTime,this.#t))&&this.#g();const r=this.#x();n&&(this.#t!==s||me(this.options.enabled,this.#t)!==me(t.enabled,this.#t)||r!==this.#l)&&this.#y(r)}getOptimisticResult(e){const t=this.#e.getQueryCache().build(this.#e,e),s=this.createResult(t,e);return Tn(this,s)&&(this.#r=s,this.#o=this.options,this.#n=this.#t.state),s}getCurrentResult(){return this.#r}trackResult(e,t){return new Proxy(e,{get:(s,n)=>(this.trackProp(n),t?.(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,n))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#t}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#d({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#d(e){this.#j();let t=this.#t.fetch(this.options,e);return e?.throwOnError||(t=t.catch(ue)),t}#g(){this.#w();const e=we(this.options.staleTime,this.#t);if(Te||this.#r.isStale||!gt(e))return;const s=vs(this.#r.dataUpdatedAt,e)+1;this.#c=Se.setTimeout(()=>{this.#r.isStale||this.updateResult()},s)}#x(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#y(e){this.#v(),this.#l=e,!(Te||me(this.options.enabled,this.#t)===!1||!gt(this.#l)||this.#l===0)&&(this.#u=Se.setInterval(()=>{(this.options.refetchIntervalInBackground||Ot.isFocused())&&this.#d()},this.#l))}#b(){this.#g(),this.#y(this.#x())}#w(){this.#c&&(Se.clearTimeout(this.#c),this.#c=void 0)}#v(){this.#u&&(Se.clearInterval(this.#u),this.#u=void 0)}createResult(e,t){const s=this.#t,n=this.options,r=this.#r,a=this.#n,o=this.#o,h=e!==s?e.state:this.#s,{state:u}=e;let c={...u},d=!1,x;if(t._optimisticResults){const R=this.hasListeners(),v=!R&&Ht(e,t),k=R&&zt(e,s,t,n);(v||k)&&(c={...c,...Rs(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(c.fetchStatus="idle")}let{error:b,errorUpdatedAt:f,status:y}=c;x=c.data;let p=!1;if(t.placeholderData!==void 0&&x===void 0&&y==="pending"){let R;r?.isPlaceholderData&&t.placeholderData===o?.placeholderData?(R=r.data,p=!0):R=typeof t.placeholderData=="function"?t.placeholderData(this.#f?.state.data,this.#f):t.placeholderData,R!==void 0&&(y="success",x=bt(r?.data,R,t),d=!0)}if(t.select&&x!==void 0&&!p)if(r&&x===a?.data&&t.select===this.#p)x=this.#h;else try{this.#p=t.select,x=t.select(x),x=bt(r?.data,x,t),this.#h=x,this.#i=null}catch(R){this.#i=R}this.#i&&(b=this.#i,x=this.#h,f=Date.now(),y="error");const F=c.fetchStatus==="fetching",T=y==="pending",j=y==="error",S=T&&F,P=x!==void 0,O={status:y,fetchStatus:c.fetchStatus,isPending:T,isSuccess:y==="success",isError:j,isInitialLoading:S,isLoading:S,data:x,dataUpdatedAt:c.dataUpdatedAt,error:b,errorUpdatedAt:f,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>h.dataUpdateCount||c.errorUpdateCount>h.errorUpdateCount,isFetching:F,isRefetching:F&&!T,isLoadingError:j&&!P,isPaused:c.fetchStatus==="paused",isPlaceholderData:d,isRefetchError:j&&P,isStale:kt(e,t),refetch:this.refetch,promise:this.#a,isEnabled:me(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const R=O.data!==void 0,v=O.status==="error"&&!R,k=L=>{v?L.reject(O.error):R&&L.resolve(O.data)},E=()=>{const L=this.#a=O.promise=wt();k(L)},C=this.#a;switch(C.status){case"pending":e.queryHash===s.queryHash&&k(C);break;case"fulfilled":(v||O.data!==C.value)&&E();break;case"rejected":(!v||O.error!==C.reason)&&E();break}}return O}updateResult(){const e=this.#r,t=this.createResult(this.#t,this.options);if(this.#n=this.#t.state,this.#o=this.options,this.#n.data!==void 0&&(this.#f=this.#t),xt(t,e))return;this.#r=t;const s=()=>{if(!e)return!0;const{notifyOnChangeProps:n}=this.options,r=typeof n=="function"?n():n;if(r==="all"||!r&&!this.#m.size)return!0;const a=new Set(r??this.#m);return this.options.throwOnError&&a.add("error"),Object.keys(this.#r).some(o=>{const l=o;return this.#r[l]!==e[l]&&a.has(l)})};this.#S({listeners:s()})}#j(){const e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#t)return;const t=this.#t;this.#t=e,this.#s=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#S(e){ie.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#r)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function Nn(e,t){return me(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Ht(e,t){return Nn(e,t)||e.state.data!==void 0&&jt(e,t,t.refetchOnMount)}function jt(e,t,s){if(me(t.enabled,e)!==!1&&we(t.staleTime,e)!=="static"){const n=typeof s=="function"?s(e):s;return n==="always"||n!==!1&&kt(e,t)}return!1}function zt(e,t,s,n){return(e!==t||me(n.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&kt(e,s)}function kt(e,t){return me(t.enabled,e)!==!1&&e.isStaleByTime(we(t.staleTime,e))}function Tn(e,t){return!xt(e.getCurrentResult(),t)}function Qt(e){return{onFetch:(t,s)=>{const n=t.options,r=t.fetchOptions?.meta?.fetchMore?.direction,a=t.state.data?.pages||[],o=t.state.data?.pageParams||[];let l={pages:[],pageParams:[]},h=0;const u=async()=>{let c=!1;const d=f=>{xn(f,()=>t.signal,()=>c=!0)},x=Ss(t.options,t.fetchOptions),b=async(f,y,p)=>{if(c)return Promise.reject();if(y==null&&f.pages.length)return Promise.resolve(f);const T=(()=>{const _={client:t.client,queryKey:t.queryKey,pageParam:y,direction:p?"backward":"forward",meta:t.options.meta};return d(_),_})(),j=await x(T),{maxPages:S}=t.options,P=p?gn:pn;return{pages:P(f.pages,j,S),pageParams:P(f.pageParams,y,S)}};if(r&&a.length){const f=r==="backward",y=f?Fn:Wt,p={pages:a,pageParams:o},F=y(n,p);l=await b(p,F,f)}else{const f=e??a.length;do{const y=h===0?o[0]??n.initialPageParam:Wt(n,l);if(h>0&&y==null)break;l=await b(l,y),h++}while(h<f)}return l};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s):t.fetchFn=u}}}function Wt(e,{pages:t,pageParams:s}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,s[n],s):void 0}function Fn(e,{pages:t,pageParams:s}){return t.length>0?e.getPreviousPageParam?.(t[0],t,s[0],s):void 0}var Rn=class extends Fs{#e;#t;#s;#r;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#s=e.mutationCache,this.#t=[],this.state=e.state||En(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(t=>t!==e),this.scheduleGc(),this.#s.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#s.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#n({type:"continue"})},s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#r=Ts({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(a,o)=>{this.#n({type:"failed",failureCount:a,error:o})},onPause:()=>{this.#n({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#s.canRun(this)});const n=this.state.status==="pending",r=!this.#r.canStart();try{if(n)t();else{this.#n({type:"pending",variables:e,isPaused:r}),this.#s.config.onMutate&&await this.#s.config.onMutate(e,this,s);const o=await this.options.onMutate?.(e,s);o!==this.state.context&&this.#n({type:"pending",context:o,variables:e,isPaused:r})}const a=await this.#r.start();return await this.#s.config.onSuccess?.(a,e,this.state.context,this,s),await this.options.onSuccess?.(a,e,this.state.context,s),await this.#s.config.onSettled?.(a,null,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(a,null,e,this.state.context,s),this.#n({type:"success",data:a}),a}catch(a){try{await this.#s.config.onError?.(a,e,this.state.context,this,s)}catch(o){Promise.reject(o)}try{await this.options.onError?.(a,e,this.state.context,s)}catch(o){Promise.reject(o)}try{await this.#s.config.onSettled?.(void 0,a,this.state.variables,this.state.context,this,s)}catch(o){Promise.reject(o)}try{await this.options.onSettled?.(void 0,a,e,this.state.context,s)}catch(o){Promise.reject(o)}throw this.#n({type:"error",error:a}),a}finally{this.#s.runNext(this)}}#n(e){const t=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),ie.batch(()=>{this.#t.forEach(s=>{s.onMutationUpdate(e)}),this.#s.notify({mutation:this,type:"updated",action:e})})}};function En(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var On=class extends Ue{constructor(e={}){super(),this.config=e,this.#e=new Set,this.#t=new Map,this.#s=0}#e;#t;#s;build(e,t,s){const n=new Rn({client:e,mutationCache:this,mutationId:++this.#s,options:e.defaultMutationOptions(t),state:s});return this.add(n),n}add(e){this.#e.add(e);const t=Ve(e);if(typeof t=="string"){const s=this.#t.get(t);s?s.push(e):this.#t.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#e.delete(e)){const t=Ve(e);if(typeof t=="string"){const s=this.#t.get(t);if(s)if(s.length>1){const n=s.indexOf(e);n!==-1&&s.splice(n,1)}else s[0]===e&&this.#t.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Ve(e);if(typeof t=="string"){const n=this.#t.get(t)?.find(r=>r.state.status==="pending");return!n||n===e}else return!0}runNext(e){const t=Ve(e);return typeof t=="string"?this.#t.get(t)?.find(n=>n!==e&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){ie.batch(()=>{this.#e.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(e){const t={exact:!0,...e};return this.getAll().find(s=>Lt(t,s))}findAll(e={}){return this.getAll().filter(t=>Lt(e,t))}notify(e){ie.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return ie.batch(()=>Promise.all(e.map(t=>t.continue().catch(ue))))}};function Ve(e){return e.options.scope?.id}var kn=class extends Ue{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,s){const n=t.queryKey,r=t.queryHash??Rt(n,t);let a=this.get(r);return a||(a=new Sn({client:e,queryKey:n,queryHash:r,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(n)}),this.add(a)),a}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){ie.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(s=>_t(t,s))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(s=>_t(e,s)):t}notify(e){ie.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){ie.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){ie.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},An=class{#e;#t;#s;#r;#n;#o;#a;#i;constructor(e={}){this.#e=e.queryCache||new kn,this.#t=e.mutationCache||new On,this.#s=e.defaultOptions||{},this.#r=new Map,this.#n=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=Ot.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=st.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#i?.(),this.#i=void 0)}isFetching(e){return this.#e.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#t.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=this.#e.build(this,t),n=s.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(we(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return this.#e.findAll(e).map(({queryKey:t,state:s})=>{const n=s.data;return[t,n]})}setQueryData(e,t,s){const n=this.defaultQueryOptions({queryKey:e}),a=this.#e.get(n.queryHash)?.state.data,o=hn(t,a);if(o!==void 0)return this.#e.build(this,n).setData(o,{...s,manual:!0})}setQueriesData(e,t,s){return ie.batch(()=>this.#e.findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,s)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state}removeQueries(e){const t=this.#e;ie.batch(()=>{t.findAll(e).forEach(s=>{t.remove(s)})})}resetQueries(e,t){const s=this.#e;return ie.batch(()=>(s.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},n=ie.batch(()=>this.#e.findAll(e).map(r=>r.cancel(s)));return Promise.all(n).then(ue).catch(ue)}invalidateQueries(e,t={}){return ie.batch(()=>(this.#e.findAll(e).forEach(s=>{s.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},n=ie.batch(()=>this.#e.findAll(e).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let a=r.fetch(void 0,s);return s.throwOnError||(a=a.catch(ue)),r.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(ue)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const s=this.#e.build(this,t);return s.isStaleByTime(we(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ue).catch(ue)}fetchInfiniteQuery(e){return e.behavior=Qt(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ue).catch(ue)}ensureInfiniteQueryData(e){return e.behavior=Qt(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return st.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#s}setDefaultOptions(e){this.#s=e}setQueryDefaults(e,t){this.#r.set(Le(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#r.values()],s={};return t.forEach(n=>{$e(e,n.queryKey)&&Object.assign(s,n.defaultOptions)}),s}setMutationDefaults(e,t){this.#n.set(Le(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#n.values()],s={};return t.forEach(n=>{$e(e,n.mutationKey)&&Object.assign(s,n.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#s.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Rt(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Et&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#s.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Es=w.createContext(void 0),Os=e=>{const t=w.useContext(Es);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Mn=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),i.jsx(Es.Provider,{value:e,children:t})),ks=w.createContext(!1),Pn=()=>w.useContext(ks);ks.Provider;function In(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Dn=w.createContext(In()),_n=()=>w.useContext(Dn),Ln=(e,t,s)=>{const n=s?.state.error&&typeof e.throwOnError=="function"?Cs(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||n)&&(t.isReset()||(e.retryOnMount=!1))},$n=e=>{w.useEffect(()=>{e.clearReset()},[e])},Un=({result:e,errorResetBoundary:t,throwOnError:s,query:n,suspense:r})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(r&&e.data===void 0||Cs(s,[e.error,n])),Bn=e=>{if(e.suspense){const s=r=>r==="static"?r:Math.max(r??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...r)=>s(n(...r)):s(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},qn=(e,t)=>e.isLoading&&e.isFetching&&!t,Hn=(e,t)=>e?.suspense&&t.isPending,Gt=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function zn(e,t,s){const n=Pn(),r=_n(),a=Os(),o=a.defaultQueryOptions(e);a.getDefaultOptions().queries?._experimental_beforeQuery?.(o);const l=a.getQueryCache().get(o.queryHash);o._optimisticResults=n?"isRestoring":"optimistic",Bn(o),Ln(o,r,l),$n(r);const h=!a.getQueryCache().get(o.queryHash),[u]=w.useState(()=>new t(a,o)),c=u.getOptimisticResult(o),d=!n&&e.subscribed!==!1;if(w.useSyncExternalStore(w.useCallback(x=>{const b=d?u.subscribe(ie.batchCalls(x)):ue;return u.updateResult(),b},[u,d]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),w.useEffect(()=>{u.setOptions(o)},[o,u]),Hn(o,c))throw Gt(o,u,r);if(Un({result:c,errorResetBoundary:r,throwOnError:o.throwOnError,query:l,suspense:o.suspense}))throw c.error;return a.getDefaultOptions().queries?._experimental_afterQuery?.(o,c),o.experimental_prefetchInRender&&!Te&&qn(c,n)&&(h?Gt(o,u,r):l?.promise)?.catch(ue).finally(()=>{u.updateResult()}),o.notifyOnChangeProps?c:u.trackResult(c)}function Ie(e,t){return zn(e,Cn)}const Vt=e=>{let t;const s=new Set,n=(u,c)=>{const d=typeof u=="function"?u(t):u;if(!Object.is(d,t)){const x=t;t=c??(typeof d!="object"||d===null)?d:Object.assign({},t,d),s.forEach(b=>b(t,x))}},r=()=>t,l={setState:n,getState:r,getInitialState:()=>h,subscribe:u=>(s.add(u),()=>s.delete(u))},h=t=e(n,r,l);return l},Qn=(e=>e?Vt(e):Vt),Wn=e=>e;function Gn(e,t=Wn){const s=Ge.useSyncExternalStore(e.subscribe,Ge.useCallback(()=>t(e.getState()),[e,t]),Ge.useCallback(()=>t(e.getInitialState()),[e,t]));return Ge.useDebugValue(s),s}const Kt=e=>{const t=Qn(e),s=n=>Gn(t,n);return Object.assign(s,t),s},Vn=(e=>e?Kt(e):Kt);function Ee(e,t){try{const s=`thermal-viewer-image-${e}`;localStorage.setItem(s,JSON.stringify(t))}catch(s){console.warn("Failed to save image settings:",s)}}function Xt(e){try{const t=`thermal-viewer-image-${e}`,s=localStorage.getItem(t);if(s)return JSON.parse(s)}catch(t){console.warn("Failed to load image settings:",t)}return null}const ye=Vn(e=>({currentImage:null,thermalStats:null,viewMode:"overlay",colormap:"hot_iron",opacity:.6,minTemp:0,maxTemp:100,displayMinTemp:0,displayMaxTemp:100,markers:[],hoverTemp:null,zoom:1,panX:0,panY:0,thermalZoom:1,alignOffsetX:0,alignOffsetY:0,isLoading:!1,setCurrentImage:t=>e(s=>{if(s.currentImage&&Ee(s.currentImage.id,{colormap:s.colormap,displayMinTemp:s.displayMinTemp,displayMaxTemp:s.displayMaxTemp,markers:s.markers}),t){const n=Xt(t.id);if(n)return{currentImage:t,colormap:n.colormap,displayMinTemp:n.displayMinTemp,displayMaxTemp:n.displayMaxTemp,markers:n.markers}}return{currentImage:t,markers:[]}}),setThermalStats:t=>e(s=>{const n=s.currentImage&&Xt(s.currentImage.id)!==null;return{thermalStats:t,minTemp:t?.minTemp??s.minTemp,maxTemp:t?.maxTemp??s.maxTemp,displayMinTemp:n?s.displayMinTemp:t?.minTemp??s.displayMinTemp,displayMaxTemp:n?s.displayMaxTemp:t?.maxTemp??s.displayMaxTemp}}),setViewMode:t=>e({viewMode:t}),setColormap:t=>e(s=>(s.currentImage&&Ee(s.currentImage.id,{colormap:t,displayMinTemp:s.displayMinTemp,displayMaxTemp:s.displayMaxTemp,markers:s.markers}),{colormap:t})),setOpacity:t=>e({opacity:t}),setDisplayTempRange:(t,s)=>e(n=>(n.currentImage&&Ee(n.currentImage.id,{colormap:n.colormap,displayMinTemp:t,displayMaxTemp:s,markers:n.markers}),{displayMinTemp:t,displayMaxTemp:s})),setTempRange:(t,s)=>e({minTemp:t,maxTemp:s}),addMarker:t=>e(s=>{const n=[...s.markers,t];return s.currentImage&&Ee(s.currentImage.id,{colormap:s.colormap,displayMinTemp:s.displayMinTemp,displayMaxTemp:s.displayMaxTemp,markers:n}),{markers:n}}),removeMarker:t=>e(s=>{const n=s.markers.filter(r=>r.id!==t);return s.currentImage&&Ee(s.currentImage.id,{colormap:s.colormap,displayMinTemp:s.displayMinTemp,displayMaxTemp:s.displayMaxTemp,markers:n}),{markers:n}}),clearMarkers:()=>e(t=>(t.currentImage&&Ee(t.currentImage.id,{colormap:t.colormap,displayMinTemp:t.displayMinTemp,displayMaxTemp:t.displayMaxTemp,markers:[]}),{markers:[]})),setHoverTemp:t=>e({hoverTemp:t}),setZoom:t=>e({zoom:Math.max(.5,Math.min(5,t))}),setPan:(t,s)=>e({panX:t,panY:s}),resetView:()=>e({zoom:1,panX:0,panY:0}),setLoading:t=>e({isLoading:t}),setThermalZoom:t=>e({thermalZoom:Math.max(1,Math.min(8,t))}),setAlignOffset:(t,s)=>e({alignOffsetX:t,alignOffsetY:s})}));function As(e,t){return function(){return e.apply(t,arguments)}}const{toString:Kn}=Object.prototype,{getPrototypeOf:At}=Object,{iterator:rt,toStringTag:Ms}=Symbol,it=(e=>t=>{const s=Kn.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),pe=e=>(e=e.toLowerCase(),t=>it(t)===e),at=e=>t=>typeof t===e,{isArray:Ae}=Array,ke=at("undefined");function Be(e){return e!==null&&!ke(e)&&e.constructor!==null&&!ke(e.constructor)&&de(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ps=pe("ArrayBuffer");function Xn(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Ps(e.buffer),t}const Yn=at("string"),de=at("function"),Is=at("number"),qe=e=>e!==null&&typeof e=="object",Jn=e=>e===!0||e===!1,Ye=e=>{if(it(e)!=="object")return!1;const t=At(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ms in e)&&!(rt in e)},Zn=e=>{if(!qe(e)||Be(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},er=pe("Date"),tr=pe("File"),sr=pe("Blob"),nr=pe("FileList"),rr=e=>qe(e)&&de(e.pipe),ir=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||de(e.append)&&((t=it(e))==="formdata"||t==="object"&&de(e.toString)&&e.toString()==="[object FormData]"))},ar=pe("URLSearchParams"),[or,lr,cr,ur]=["ReadableStream","Request","Response","Headers"].map(pe),dr=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function He(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let n,r;if(typeof e!="object"&&(e=[e]),Ae(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{if(Be(e))return;const a=s?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let l;for(n=0;n<o;n++)l=a[n],t.call(null,e[l],l,e)}}function Ds(e,t){if(Be(e))return null;t=t.toLowerCase();const s=Object.keys(e);let n=s.length,r;for(;n-- >0;)if(r=s[n],t===r.toLowerCase())return r;return null}const Ce=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_s=e=>!ke(e)&&e!==Ce;function St(){const{caseless:e,skipUndefined:t}=_s(this)&&this||{},s={},n=(r,a)=>{const o=e&&Ds(s,a)||a;Ye(s[o])&&Ye(r)?s[o]=St(s[o],r):Ye(r)?s[o]=St({},r):Ae(r)?s[o]=r.slice():(!t||!ke(r))&&(s[o]=r)};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&He(arguments[r],n);return s}const hr=(e,t,s,{allOwnKeys:n}={})=>(He(t,(r,a)=>{s&&de(r)?Object.defineProperty(e,a,{value:As(r,s),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,a,{value:r,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:n}),e),fr=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),mr=(e,t,s,n)=>{e.prototype=Object.create(t.prototype,n),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},pr=(e,t,s,n)=>{let r,a,o;const l={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),a=r.length;a-- >0;)o=r[a],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=s!==!1&&At(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},gr=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const n=e.indexOf(t,s);return n!==-1&&n===s},xr=e=>{if(!e)return null;if(Ae(e))return e;let t=e.length;if(!Is(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},yr=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&At(Uint8Array)),br=(e,t)=>{const n=(e&&e[rt]).call(e);let r;for(;(r=n.next())&&!r.done;){const a=r.value;t.call(e,a[0],a[1])}},wr=(e,t)=>{let s;const n=[];for(;(s=e.exec(t))!==null;)n.push(s);return n},vr=pe("HTMLFormElement"),jr=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,r){return n.toUpperCase()+r}),Yt=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),Sr=pe("RegExp"),Ls=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),n={};He(s,(r,a)=>{let o;(o=t(r,a,e))!==!1&&(n[a]=o||r)}),Object.defineProperties(e,n)},Cr=e=>{Ls(e,(t,s)=>{if(de(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=e[s];if(de(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},Nr=(e,t)=>{const s={},n=r=>{r.forEach(a=>{s[a]=!0})};return Ae(e)?n(e):n(String(e).split(t)),s},Tr=()=>{},Fr=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Rr(e){return!!(e&&de(e.append)&&e[Ms]==="FormData"&&e[rt])}const Er=e=>{const t=new Array(10),s=(n,r)=>{if(qe(n)){if(t.indexOf(n)>=0)return;if(Be(n))return n;if(!("toJSON"in n)){t[r]=n;const a=Ae(n)?[]:{};return He(n,(o,l)=>{const h=s(o,r+1);!ke(h)&&(a[l]=h)}),t[r]=void 0,a}}return n};return s(e,0)},Or=pe("AsyncFunction"),kr=e=>e&&(qe(e)||de(e))&&de(e.then)&&de(e.catch),$s=((e,t)=>e?setImmediate:t?((s,n)=>(Ce.addEventListener("message",({source:r,data:a})=>{r===Ce&&a===s&&n.length&&n.shift()()},!1),r=>{n.push(r),Ce.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",de(Ce.postMessage)),Ar=typeof queueMicrotask<"u"?queueMicrotask.bind(Ce):typeof process<"u"&&process.nextTick||$s,Mr=e=>e!=null&&de(e[rt]),m={isArray:Ae,isArrayBuffer:Ps,isBuffer:Be,isFormData:ir,isArrayBufferView:Xn,isString:Yn,isNumber:Is,isBoolean:Jn,isObject:qe,isPlainObject:Ye,isEmptyObject:Zn,isReadableStream:or,isRequest:lr,isResponse:cr,isHeaders:ur,isUndefined:ke,isDate:er,isFile:tr,isBlob:sr,isRegExp:Sr,isFunction:de,isStream:rr,isURLSearchParams:ar,isTypedArray:yr,isFileList:nr,forEach:He,merge:St,extend:hr,trim:dr,stripBOM:fr,inherits:mr,toFlatObject:pr,kindOf:it,kindOfTest:pe,endsWith:gr,toArray:xr,forEachEntry:br,matchAll:wr,isHTMLForm:vr,hasOwnProperty:Yt,hasOwnProp:Yt,reduceDescriptors:Ls,freezeMethods:Cr,toObjectSet:Nr,toCamelCase:jr,noop:Tr,toFiniteNumber:Fr,findKey:Ds,global:Ce,isContextDefined:_s,isSpecCompliantForm:Rr,toJSONObject:Er,isAsyncFn:Or,isThenable:kr,setImmediate:$s,asap:Ar,isIterable:Mr};let M=class Us extends Error{static from(t,s,n,r,a,o){const l=new Us(t.message,s||t.code,n,r,a);return l.cause=t,l.name=t.name,o&&Object.assign(l,o),l}constructor(t,s,n,r,a){super(t),this.name="AxiosError",this.isAxiosError=!0,s&&(this.code=s),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:m.toJSONObject(this.config),code:this.code,status:this.status}}};M.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";M.ERR_BAD_OPTION="ERR_BAD_OPTION";M.ECONNABORTED="ECONNABORTED";M.ETIMEDOUT="ETIMEDOUT";M.ERR_NETWORK="ERR_NETWORK";M.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";M.ERR_DEPRECATED="ERR_DEPRECATED";M.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";M.ERR_BAD_REQUEST="ERR_BAD_REQUEST";M.ERR_CANCELED="ERR_CANCELED";M.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";M.ERR_INVALID_URL="ERR_INVALID_URL";const Pr=null;function Ct(e){return m.isPlainObject(e)||m.isArray(e)}function Bs(e){return m.endsWith(e,"[]")?e.slice(0,-2):e}function Jt(e,t,s){return e?e.concat(t).map(function(r,a){return r=Bs(r),!s&&a?"["+r+"]":r}).join(s?".":""):t}function Ir(e){return m.isArray(e)&&!e.some(Ct)}const Dr=m.toFlatObject(m,{},null,function(t){return/^is[A-Z]/.test(t)});function ot(e,t,s){if(!m.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,s=m.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,p){return!m.isUndefined(p[y])});const n=s.metaTokens,r=s.visitor||c,a=s.dots,o=s.indexes,h=(s.Blob||typeof Blob<"u"&&Blob)&&m.isSpecCompliantForm(t);if(!m.isFunction(r))throw new TypeError("visitor must be a function");function u(f){if(f===null)return"";if(m.isDate(f))return f.toISOString();if(m.isBoolean(f))return f.toString();if(!h&&m.isBlob(f))throw new M("Blob is not supported. Use a Buffer instead.");return m.isArrayBuffer(f)||m.isTypedArray(f)?h&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function c(f,y,p){let F=f;if(f&&!p&&typeof f=="object"){if(m.endsWith(y,"{}"))y=n?y:y.slice(0,-2),f=JSON.stringify(f);else if(m.isArray(f)&&Ir(f)||(m.isFileList(f)||m.endsWith(y,"[]"))&&(F=m.toArray(f)))return y=Bs(y),F.forEach(function(j,S){!(m.isUndefined(j)||j===null)&&t.append(o===!0?Jt([y],S,a):o===null?y:y+"[]",u(j))}),!1}return Ct(f)?!0:(t.append(Jt(p,y,a),u(f)),!1)}const d=[],x=Object.assign(Dr,{defaultVisitor:c,convertValue:u,isVisitable:Ct});function b(f,y){if(!m.isUndefined(f)){if(d.indexOf(f)!==-1)throw Error("Circular reference detected in "+y.join("."));d.push(f),m.forEach(f,function(F,T){(!(m.isUndefined(F)||F===null)&&r.call(t,F,m.isString(T)?T.trim():T,y,x))===!0&&b(F,y?y.concat(T):[T])}),d.pop()}}if(!m.isObject(e))throw new TypeError("data must be an object");return b(e),t}function Zt(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Mt(e,t){this._pairs=[],e&&ot(e,this,t)}const qs=Mt.prototype;qs.append=function(t,s){this._pairs.push([t,s])};qs.toString=function(t){const s=t?function(n){return t.call(this,n,Zt)}:Zt;return this._pairs.map(function(r){return s(r[0])+"="+s(r[1])},"").join("&")};function _r(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Hs(e,t,s){if(!t)return e;const n=s&&s.encode||_r,r=m.isFunction(s)?{serialize:s}:s,a=r&&r.serialize;let o;if(a?o=a(t,r):o=m.isURLSearchParams(t)?t.toString():new Mt(t,r).toString(n),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class es{constructor(){this.handlers=[]}use(t,s,n){return this.handlers.push({fulfilled:t,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){m.forEach(this.handlers,function(n){n!==null&&t(n)})}}const zs={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Lr=typeof URLSearchParams<"u"?URLSearchParams:Mt,$r=typeof FormData<"u"?FormData:null,Ur=typeof Blob<"u"?Blob:null,Br={isBrowser:!0,classes:{URLSearchParams:Lr,FormData:$r,Blob:Ur},protocols:["http","https","file","blob","url","data"]},Pt=typeof window<"u"&&typeof document<"u",Nt=typeof navigator=="object"&&navigator||void 0,qr=Pt&&(!Nt||["ReactNative","NativeScript","NS"].indexOf(Nt.product)<0),Hr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",zr=Pt&&window.location.href||"http://localhost",Qr=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Pt,hasStandardBrowserEnv:qr,hasStandardBrowserWebWorkerEnv:Hr,navigator:Nt,origin:zr},Symbol.toStringTag,{value:"Module"})),oe={...Qr,...Br};function Wr(e,t){return ot(e,new oe.classes.URLSearchParams,{visitor:function(s,n,r,a){return oe.isNode&&m.isBuffer(s)?(this.append(n,s.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function Gr(e){return m.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Vr(e){const t={},s=Object.keys(e);let n;const r=s.length;let a;for(n=0;n<r;n++)a=s[n],t[a]=e[a];return t}function Qs(e){function t(s,n,r,a){let o=s[a++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),h=a>=s.length;return o=!o&&m.isArray(r)?r.length:o,h?(m.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!l):((!r[o]||!m.isObject(r[o]))&&(r[o]=[]),t(s,n,r[o],a)&&m.isArray(r[o])&&(r[o]=Vr(r[o])),!l)}if(m.isFormData(e)&&m.isFunction(e.entries)){const s={};return m.forEachEntry(e,(n,r)=>{t(Gr(n),r,s,0)}),s}return null}function Kr(e,t,s){if(m.isString(e))try{return(t||JSON.parse)(e),m.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(e)}const ze={transitional:zs,adapter:["xhr","http","fetch"],transformRequest:[function(t,s){const n=s.getContentType()||"",r=n.indexOf("application/json")>-1,a=m.isObject(t);if(a&&m.isHTMLForm(t)&&(t=new FormData(t)),m.isFormData(t))return r?JSON.stringify(Qs(t)):t;if(m.isArrayBuffer(t)||m.isBuffer(t)||m.isStream(t)||m.isFile(t)||m.isBlob(t)||m.isReadableStream(t))return t;if(m.isArrayBufferView(t))return t.buffer;if(m.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Wr(t,this.formSerializer).toString();if((l=m.isFileList(t))||n.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return ot(l?{"files[]":t}:t,h&&new h,this.formSerializer)}}return a||r?(s.setContentType("application/json",!1),Kr(t)):t}],transformResponse:[function(t){const s=this.transitional||ze.transitional,n=s&&s.forcedJSONParsing,r=this.responseType==="json";if(m.isResponse(t)||m.isReadableStream(t))return t;if(t&&m.isString(t)&&(n&&!this.responseType||r)){const o=!(s&&s.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?M.from(l,M.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oe.classes.FormData,Blob:oe.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};m.forEach(["delete","get","head","post","put","patch"],e=>{ze.headers[e]={}});const Xr=m.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Yr=e=>{const t={};let s,n,r;return e&&e.split(`
`).forEach(function(o){r=o.indexOf(":"),s=o.substring(0,r).trim().toLowerCase(),n=o.substring(r+1).trim(),!(!s||t[s]&&Xr[s])&&(s==="set-cookie"?t[s]?t[s].push(n):t[s]=[n]:t[s]=t[s]?t[s]+", "+n:n)}),t},ts=Symbol("internals");function De(e){return e&&String(e).trim().toLowerCase()}function Je(e){return e===!1||e==null?e:m.isArray(e)?e.map(Je):String(e)}function Jr(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(e);)t[n[1]]=n[2];return t}const Zr=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ut(e,t,s,n,r){if(m.isFunction(n))return n.call(this,t,s);if(r&&(t=s),!!m.isString(t)){if(m.isString(n))return t.indexOf(n)!==-1;if(m.isRegExp(n))return n.test(t)}}function ei(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,n)=>s.toUpperCase()+n)}function ti(e,t){const s=m.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+s,{value:function(r,a,o){return this[n].call(this,t,r,a,o)},configurable:!0})})}let he=class{constructor(t){t&&this.set(t)}set(t,s,n){const r=this;function a(l,h,u){const c=De(h);if(!c)throw new Error("header name must be a non-empty string");const d=m.findKey(r,c);(!d||r[d]===void 0||u===!0||u===void 0&&r[d]!==!1)&&(r[d||h]=Je(l))}const o=(l,h)=>m.forEach(l,(u,c)=>a(u,c,h));if(m.isPlainObject(t)||t instanceof this.constructor)o(t,s);else if(m.isString(t)&&(t=t.trim())&&!Zr(t))o(Yr(t),s);else if(m.isObject(t)&&m.isIterable(t)){let l={},h,u;for(const c of t){if(!m.isArray(c))throw TypeError("Object iterator must return a key-value pair");l[u=c[0]]=(h=l[u])?m.isArray(h)?[...h,c[1]]:[h,c[1]]:c[1]}o(l,s)}else t!=null&&a(s,t,n);return this}get(t,s){if(t=De(t),t){const n=m.findKey(this,t);if(n){const r=this[n];if(!s)return r;if(s===!0)return Jr(r);if(m.isFunction(s))return s.call(this,r,n);if(m.isRegExp(s))return s.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=De(t),t){const n=m.findKey(this,t);return!!(n&&this[n]!==void 0&&(!s||ut(this,this[n],n,s)))}return!1}delete(t,s){const n=this;let r=!1;function a(o){if(o=De(o),o){const l=m.findKey(n,o);l&&(!s||ut(n,n[l],l,s))&&(delete n[l],r=!0)}}return m.isArray(t)?t.forEach(a):a(t),r}clear(t){const s=Object.keys(this);let n=s.length,r=!1;for(;n--;){const a=s[n];(!t||ut(this,this[a],a,t,!0))&&(delete this[a],r=!0)}return r}normalize(t){const s=this,n={};return m.forEach(this,(r,a)=>{const o=m.findKey(n,a);if(o){s[o]=Je(r),delete s[a];return}const l=t?ei(a):String(a).trim();l!==a&&delete s[a],s[l]=Je(r),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return m.forEach(this,(n,r)=>{n!=null&&n!==!1&&(s[r]=t&&m.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const n=new this(t);return s.forEach(r=>n.set(r)),n}static accessor(t){const n=(this[ts]=this[ts]={accessors:{}}).accessors,r=this.prototype;function a(o){const l=De(o);n[l]||(ti(r,o),n[l]=!0)}return m.isArray(t)?t.forEach(a):a(t),this}};he.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);m.reduceDescriptors(he.prototype,({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[s]=n}}});m.freezeMethods(he);function dt(e,t){const s=this||ze,n=t||s,r=he.from(n.headers);let a=n.data;return m.forEach(e,function(l){a=l.call(s,a,r.normalize(),t?t.status:void 0)}),r.normalize(),a}function Ws(e){return!!(e&&e.__CANCEL__)}let Qe=class extends M{constructor(t,s,n){super(t??"canceled",M.ERR_CANCELED,s,n),this.name="CanceledError",this.__CANCEL__=!0}};function Gs(e,t,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?e(s):t(new M("Request failed with status code "+s.status,[M.ERR_BAD_REQUEST,M.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function si(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function ni(e,t){e=e||10;const s=new Array(e),n=new Array(e);let r=0,a=0,o;return t=t!==void 0?t:1e3,function(h){const u=Date.now(),c=n[a];o||(o=u),s[r]=h,n[r]=u;let d=a,x=0;for(;d!==r;)x+=s[d++],d=d%e;if(r=(r+1)%e,r===a&&(a=(a+1)%e),u-o<t)return;const b=c&&u-c;return b?Math.round(x*1e3/b):void 0}}function ri(e,t){let s=0,n=1e3/t,r,a;const o=(u,c=Date.now())=>{s=c,r=null,a&&(clearTimeout(a),a=null),e(...u)};return[(...u)=>{const c=Date.now(),d=c-s;d>=n?o(u,c):(r=u,a||(a=setTimeout(()=>{a=null,o(r)},n-d)))},()=>r&&o(r)]}const nt=(e,t,s=3)=>{let n=0;const r=ni(50,250);return ri(a=>{const o=a.loaded,l=a.lengthComputable?a.total:void 0,h=o-n,u=r(h),c=o<=l;n=o;const d={loaded:o,total:l,progress:l?o/l:void 0,bytes:h,rate:u||void 0,estimated:u&&l&&c?(l-o)/u:void 0,event:a,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(d)},s)},ss=(e,t)=>{const s=e!=null;return[n=>t[0]({lengthComputable:s,total:e,loaded:n}),t[1]]},ns=e=>(...t)=>m.asap(()=>e(...t)),ii=oe.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,oe.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(oe.origin),oe.navigator&&/(msie|trident)/i.test(oe.navigator.userAgent)):()=>!0,ai=oe.hasStandardBrowserEnv?{write(e,t,s,n,r,a,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];m.isNumber(s)&&l.push(`expires=${new Date(s).toUTCString()}`),m.isString(n)&&l.push(`path=${n}`),m.isString(r)&&l.push(`domain=${r}`),a===!0&&l.push("secure"),m.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function oi(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function li(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Vs(e,t,s){let n=!oi(t);return e&&(n||s==!1)?li(e,t):t}const rs=e=>e instanceof he?{...e}:e;function Fe(e,t){t=t||{};const s={};function n(u,c,d,x){return m.isPlainObject(u)&&m.isPlainObject(c)?m.merge.call({caseless:x},u,c):m.isPlainObject(c)?m.merge({},c):m.isArray(c)?c.slice():c}function r(u,c,d,x){if(m.isUndefined(c)){if(!m.isUndefined(u))return n(void 0,u,d,x)}else return n(u,c,d,x)}function a(u,c){if(!m.isUndefined(c))return n(void 0,c)}function o(u,c){if(m.isUndefined(c)){if(!m.isUndefined(u))return n(void 0,u)}else return n(void 0,c)}function l(u,c,d){if(d in t)return n(u,c);if(d in e)return n(void 0,u)}const h={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,c,d)=>r(rs(u),rs(c),d,!0)};return m.forEach(Object.keys({...e,...t}),function(c){const d=h[c]||r,x=d(e[c],t[c],c);m.isUndefined(x)&&d!==l||(s[c]=x)}),s}const Ks=e=>{const t=Fe({},e);let{data:s,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:a,headers:o,auth:l}=t;if(t.headers=o=he.from(o),t.url=Hs(Vs(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),m.isFormData(s)){if(oe.hasStandardBrowserEnv||oe.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(m.isFunction(s.getHeaders)){const h=s.getHeaders(),u=["content-type","content-length"];Object.entries(h).forEach(([c,d])=>{u.includes(c.toLowerCase())&&o.set(c,d)})}}if(oe.hasStandardBrowserEnv&&(n&&m.isFunction(n)&&(n=n(t)),n||n!==!1&&ii(t.url))){const h=r&&a&&ai.read(a);h&&o.set(r,h)}return t},ci=typeof XMLHttpRequest<"u",ui=ci&&function(e){return new Promise(function(s,n){const r=Ks(e);let a=r.data;const o=he.from(r.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:u}=r,c,d,x,b,f;function y(){b&&b(),f&&f(),r.cancelToken&&r.cancelToken.unsubscribe(c),r.signal&&r.signal.removeEventListener("abort",c)}let p=new XMLHttpRequest;p.open(r.method.toUpperCase(),r.url,!0),p.timeout=r.timeout;function F(){if(!p)return;const j=he.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),P={data:!l||l==="text"||l==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:j,config:e,request:p};Gs(function(O){s(O),y()},function(O){n(O),y()},P),p=null}"onloadend"in p?p.onloadend=F:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(F)},p.onabort=function(){p&&(n(new M("Request aborted",M.ECONNABORTED,e,p)),p=null)},p.onerror=function(S){const P=S&&S.message?S.message:"Network Error",_=new M(P,M.ERR_NETWORK,e,p);_.event=S||null,n(_),p=null},p.ontimeout=function(){let S=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const P=r.transitional||zs;r.timeoutErrorMessage&&(S=r.timeoutErrorMessage),n(new M(S,P.clarifyTimeoutError?M.ETIMEDOUT:M.ECONNABORTED,e,p)),p=null},a===void 0&&o.setContentType(null),"setRequestHeader"in p&&m.forEach(o.toJSON(),function(S,P){p.setRequestHeader(P,S)}),m.isUndefined(r.withCredentials)||(p.withCredentials=!!r.withCredentials),l&&l!=="json"&&(p.responseType=r.responseType),u&&([x,f]=nt(u,!0),p.addEventListener("progress",x)),h&&p.upload&&([d,b]=nt(h),p.upload.addEventListener("progress",d),p.upload.addEventListener("loadend",b)),(r.cancelToken||r.signal)&&(c=j=>{p&&(n(!j||j.type?new Qe(null,e,p):j),p.abort(),p=null)},r.cancelToken&&r.cancelToken.subscribe(c),r.signal&&(r.signal.aborted?c():r.signal.addEventListener("abort",c)));const T=si(r.url);if(T&&oe.protocols.indexOf(T)===-1){n(new M("Unsupported protocol "+T+":",M.ERR_BAD_REQUEST,e));return}p.send(a||null)})},di=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let n=new AbortController,r;const a=function(u){if(!r){r=!0,l();const c=u instanceof Error?u:this.reason;n.abort(c instanceof M?c:new Qe(c instanceof Error?c.message:c))}};let o=t&&setTimeout(()=>{o=null,a(new M(`timeout of ${t}ms exceeded`,M.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),e=null)};e.forEach(u=>u.addEventListener("abort",a));const{signal:h}=n;return h.unsubscribe=()=>m.asap(l),h}},hi=function*(e,t){let s=e.byteLength;if(s<t){yield e;return}let n=0,r;for(;n<s;)r=n+t,yield e.slice(n,r),n=r},fi=async function*(e,t){for await(const s of mi(e))yield*hi(s,t)},mi=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:s,value:n}=await t.read();if(s)break;yield n}}finally{await t.cancel()}},is=(e,t,s,n)=>{const r=fi(e,t);let a=0,o,l=h=>{o||(o=!0,n&&n(h))};return new ReadableStream({async pull(h){try{const{done:u,value:c}=await r.next();if(u){l(),h.close();return}let d=c.byteLength;if(s){let x=a+=d;s(x)}h.enqueue(new Uint8Array(c))}catch(u){throw l(u),u}},cancel(h){return l(h),r.return()}},{highWaterMark:2})},as=64*1024,{isFunction:Ke}=m,pi=(({Request:e,Response:t})=>({Request:e,Response:t}))(m.global),{ReadableStream:os,TextEncoder:ls}=m.global,cs=(e,...t)=>{try{return!!e(...t)}catch{return!1}},gi=e=>{e=m.merge.call({skipUndefined:!0},pi,e);const{fetch:t,Request:s,Response:n}=e,r=t?Ke(t):typeof fetch=="function",a=Ke(s),o=Ke(n);if(!r)return!1;const l=r&&Ke(os),h=r&&(typeof ls=="function"?(f=>y=>f.encode(y))(new ls):async f=>new Uint8Array(await new s(f).arrayBuffer())),u=a&&l&&cs(()=>{let f=!1;const y=new s(oe.origin,{body:new os,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!y}),c=o&&l&&cs(()=>m.isReadableStream(new n("").body)),d={stream:c&&(f=>f.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(f=>{!d[f]&&(d[f]=(y,p)=>{let F=y&&y[f];if(F)return F.call(y);throw new M(`Response type '${f}' is not supported`,M.ERR_NOT_SUPPORT,p)})});const x=async f=>{if(f==null)return 0;if(m.isBlob(f))return f.size;if(m.isSpecCompliantForm(f))return(await new s(oe.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(m.isArrayBufferView(f)||m.isArrayBuffer(f))return f.byteLength;if(m.isURLSearchParams(f)&&(f=f+""),m.isString(f))return(await h(f)).byteLength},b=async(f,y)=>{const p=m.toFiniteNumber(f.getContentLength());return p??x(y)};return async f=>{let{url:y,method:p,data:F,signal:T,cancelToken:j,timeout:S,onDownloadProgress:P,onUploadProgress:_,responseType:O,headers:R,withCredentials:v="same-origin",fetchOptions:k}=Ks(f),E=t||fetch;O=O?(O+"").toLowerCase():"text";let C=di([T,j&&j.toAbortSignal()],S),L=null;const g=C&&C.unsubscribe&&(()=>{C.unsubscribe()});let D;try{if(_&&u&&p!=="get"&&p!=="head"&&(D=await b(R,F))!==0){let ne=new s(y,{method:"POST",body:F,duplex:"half"}),$;if(m.isFormData(F)&&($=ne.headers.get("content-type"))&&R.setContentType($),ne.body){const[N,G]=ss(D,nt(ns(_)));F=is(ne.body,as,N,G)}}m.isString(v)||(v=v?"include":"omit");const q=a&&"credentials"in s.prototype,le={...k,signal:C,method:p.toUpperCase(),headers:R.normalize().toJSON(),body:F,duplex:"half",credentials:q?v:void 0};L=a&&new s(y,le);let Y=await(a?E(L,k):E(y,le));const fe=c&&(O==="stream"||O==="response");if(c&&(P||fe&&g)){const ne={};["status","statusText","headers"].forEach(B=>{ne[B]=Y[B]});const $=m.toFiniteNumber(Y.headers.get("content-length")),[N,G]=P&&ss($,nt(ns(P),!0))||[];Y=new n(is(Y.body,as,N,()=>{G&&G(),g&&g()}),ne)}O=O||"text";let ve=await d[m.findKey(d,O)||"text"](Y,f);return!fe&&g&&g(),await new Promise((ne,$)=>{Gs(ne,$,{data:ve,headers:he.from(Y.headers),status:Y.status,statusText:Y.statusText,config:f,request:L})})}catch(q){throw g&&g(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new M("Network Error",M.ERR_NETWORK,f,L),{cause:q.cause||q}):M.from(q,q&&q.code,f,L)}}},xi=new Map,Xs=e=>{let t=e&&e.env||{};const{fetch:s,Request:n,Response:r}=t,a=[n,r,s];let o=a.length,l=o,h,u,c=xi;for(;l--;)h=a[l],u=c.get(h),u===void 0&&c.set(h,u=l?new Map:gi(t)),c=u;return u};Xs();const It={http:Pr,xhr:ui,fetch:{get:Xs}};m.forEach(It,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const us=e=>`- ${e}`,yi=e=>m.isFunction(e)||e===null||e===!1;function bi(e,t){e=m.isArray(e)?e:[e];const{length:s}=e;let n,r;const a={};for(let o=0;o<s;o++){n=e[o];let l;if(r=n,!yi(n)&&(r=It[(l=String(n)).toLowerCase()],r===void 0))throw new M(`Unknown adapter '${l}'`);if(r&&(m.isFunction(r)||(r=r.get(t))))break;a[l||"#"+o]=r}if(!r){const o=Object.entries(a).map(([h,u])=>`adapter ${h} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=s?o.length>1?`since :
`+o.map(us).join(`
`):" "+us(o[0]):"as no adapter specified";throw new M("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r}const Ys={getAdapter:bi,adapters:It};function ht(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Qe(null,e)}function ds(e){return ht(e),e.headers=he.from(e.headers),e.data=dt.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ys.getAdapter(e.adapter||ze.adapter,e)(e).then(function(n){return ht(e),n.data=dt.call(e,e.transformResponse,n),n.headers=he.from(n.headers),n},function(n){return Ws(n)||(ht(e),n&&n.response&&(n.response.data=dt.call(e,e.transformResponse,n.response),n.response.headers=he.from(n.response.headers))),Promise.reject(n)})}const Js="1.13.4",lt={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{lt[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const hs={};lt.transitional=function(t,s,n){function r(a,o){return"[Axios v"+Js+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,l)=>{if(t===!1)throw new M(r(o," has been removed"+(s?" in "+s:"")),M.ERR_DEPRECATED);return s&&!hs[o]&&(hs[o]=!0,console.warn(r(o," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(a,o,l):!0}};lt.spelling=function(t){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function wi(e,t,s){if(typeof e!="object")throw new M("options must be an object",M.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let r=n.length;for(;r-- >0;){const a=n[r],o=t[a];if(o){const l=e[a],h=l===void 0||o(l,a,e);if(h!==!0)throw new M("option "+a+" must be "+h,M.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new M("Unknown option "+a,M.ERR_BAD_OPTION)}}const Ze={assertOptions:wi,validators:lt},ge=Ze.validators;let Ne=class{constructor(t){this.defaults=t||{},this.interceptors={request:new es,response:new es}}async request(t,s){try{return await this._request(t,s)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const a=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=Fe(this.defaults,s);const{transitional:n,paramsSerializer:r,headers:a}=s;n!==void 0&&Ze.assertOptions(n,{silentJSONParsing:ge.transitional(ge.boolean),forcedJSONParsing:ge.transitional(ge.boolean),clarifyTimeoutError:ge.transitional(ge.boolean)},!1),r!=null&&(m.isFunction(r)?s.paramsSerializer={serialize:r}:Ze.assertOptions(r,{encode:ge.function,serialize:ge.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),Ze.assertOptions(s,{baseUrl:ge.spelling("baseURL"),withXsrfToken:ge.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let o=a&&m.merge(a.common,a[s.method]);a&&m.forEach(["delete","get","head","post","put","patch","common"],f=>{delete a[f]}),s.headers=he.concat(o,a);const l=[];let h=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(s)===!1||(h=h&&y.synchronous,l.unshift(y.fulfilled,y.rejected))});const u=[];this.interceptors.response.forEach(function(y){u.push(y.fulfilled,y.rejected)});let c,d=0,x;if(!h){const f=[ds.bind(this),void 0];for(f.unshift(...l),f.push(...u),x=f.length,c=Promise.resolve(s);d<x;)c=c.then(f[d++],f[d++]);return c}x=l.length;let b=s;for(;d<x;){const f=l[d++],y=l[d++];try{b=f(b)}catch(p){y.call(this,p);break}}try{c=ds.call(this,b)}catch(f){return Promise.reject(f)}for(d=0,x=u.length;d<x;)c=c.then(u[d++],u[d++]);return c}getUri(t){t=Fe(this.defaults,t);const s=Vs(t.baseURL,t.url,t.allowAbsoluteUrls);return Hs(s,t.params,t.paramsSerializer)}};m.forEach(["delete","get","head","options"],function(t){Ne.prototype[t]=function(s,n){return this.request(Fe(n||{},{method:t,url:s,data:(n||{}).data}))}});m.forEach(["post","put","patch"],function(t){function s(n){return function(a,o,l){return this.request(Fe(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}Ne.prototype[t]=s(),Ne.prototype[t+"Form"]=s(!0)});let vi=class Zs{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(a){s=a});const n=this;this.promise.then(r=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](r);n._listeners=null}),this.promise.then=r=>{let a;const o=new Promise(l=>{n.subscribe(l),a=l}).then(r);return o.cancel=function(){n.unsubscribe(a)},o},t(function(a,o,l){n.reason||(n.reason=new Qe(a,o,l),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const t=new AbortController,s=n=>{t.abort(n)};return this.subscribe(s),t.signal.unsubscribe=()=>this.unsubscribe(s),t.signal}static source(){let t;return{token:new Zs(function(r){t=r}),cancel:t}}};function ji(e){return function(s){return e.apply(null,s)}}function Si(e){return m.isObject(e)&&e.isAxiosError===!0}const Tt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Tt).forEach(([e,t])=>{Tt[t]=e});function en(e){const t=new Ne(e),s=As(Ne.prototype.request,t);return m.extend(s,Ne.prototype,t,{allOwnKeys:!0}),m.extend(s,t,null,{allOwnKeys:!0}),s.create=function(r){return en(Fe(e,r))},s}const te=en(ze);te.Axios=Ne;te.CanceledError=Qe;te.CancelToken=vi;te.isCancel=Ws;te.VERSION=Js;te.toFormData=ot;te.AxiosError=M;te.Cancel=te.CanceledError;te.all=function(t){return Promise.all(t)};te.spread=ji;te.isAxiosError=Si;te.mergeConfig=Fe;te.AxiosHeaders=he;te.formToJSON=e=>Qs(m.isHTMLForm(e)?new FormData(e):e);te.getAdapter=Ys.getAdapter;te.HttpStatusCode=Tt;te.default=te;const{Axios:ka,AxiosError:Aa,CanceledError:Ma,isCancel:Pa,CancelToken:Ia,VERSION:Da,all:_a,Cancel:La,isAxiosError:$a,spread:Ua,toFormData:Ba,AxiosHeaders:qa,HttpStatusCode:Ha,formToJSON:za,getAdapter:Qa,mergeConfig:Wa}=te;function Ci(e,t){const s=e.length,n=t/255*(s-1),r=Math.floor(n),a=Math.min(r+1,s-1),o=n-r;return[Math.round(e[r][0]+o*(e[a][0]-e[r][0])),Math.round(e[r][1]+o*(e[a][1]-e[r][1])),Math.round(e[r][2]+o*(e[a][2]-e[r][2]))]}function Oe(e){return Array.from({length:256},(t,s)=>[...Ci(e,s)])}const fs={white_hot:Array.from({length:256},(e,t)=>[t,t,t]),black_hot:Array.from({length:256},(e,t)=>[255-t,255-t,255-t]),hot_iron:Oe([[0,0,0],[51,0,102],[102,0,153],[153,0,102],[204,51,0],[255,102,0],[255,204,51],[255,255,255]]),iron_red:Oe([[0,0,10],[30,10,60],[75,8,104],[125,17,119],[174,30,84],[217,50,22],[245,109,0],[255,169,0],[255,229,102],[255,255,255]]),fulgurite:Oe([[51,0,0],[102,0,0],[153,51,0],[204,102,0],[255,153,51],[255,204,102],[255,255,153],[255,255,255]]),medical:Oe([[0,0,51],[51,0,102],[102,0,153],[153,0,204],[204,0,255],[255,102,255],[255,204,255],[255,255,255]]),arctic:Oe([[0,0,102],[0,51,204],[0,153,255],[102,204,255],[204,255,255],[255,255,255]]),rainbow:Oe([[0,0,255],[0,255,255],[0,255,0],[255,255,0],[255,0,0]]),tint:(()=>{const e=[];for(let t=0;t<256;t++)if(t<200){const s=Math.round(t/200*180);e.push([s,s,s])}else{const s=(t-200)/55;e.push([Math.round(180+s*75),Math.round(180*(1-s*.8)),Math.round(180*(1-s*.8))])}return e})()},ms=new Map;async function Re(e,t){const s=ms.get(e);if(s)return s;const n=`${t}/thermal/${e}.bin.gz`,r=await fetch(n);if(!r.ok)throw new Error(`Failed to load thermal data: ${r.status}`);const a=await r.blob(),o=new DecompressionStream("gzip"),h=a.stream().pipeThrough(o).getReader(),u=[];let c=0;for(;;){const{done:R,value:v}=await h.read();if(R)break;u.push(v),c+=v.byteLength}const d=new Uint8Array(c);let x=0;for(const R of u)d.set(R,x),x+=R.byteLength;const b=new Float32Array(d.buffer),f=b.length;let y=640,p=512;const F=[[512,640],[256,336],[480,640],[384,512]];for(const[R,v]of F)if(R*v===f){y=v,p=R;break}let T=1/0,j=-1/0,S=0;for(let R=0;R<b.length;R++){const v=b[R];v<T&&(T=v),v>j&&(j=v),S+=v}const P=S/b.length,O={data:b,width:y,height:p,stats:{minTemp:T,maxTemp:j,meanTemp:P,width:y,height:p}};return ms.set(e,O),O}function ct(e,t,s,n){const{data:r,width:a,height:o}=e,l=new ImageData(a,o),h=fs[t]||fs.hot_iron,u=n-s;for(let c=0;c<r.length;c++){const d=Math.max(0,Math.min(1,(r[c]-s)/(u+1e-6))),x=Math.round(d*255),[b,f,y]=h[x],p=c*4;l.data[p]=b,l.data[p+1]=f,l.data[p+2]=y,l.data[p+3]=255}return l}function et(e,t,s){const n=s*e.width+t,r=e.data[n],a=(r-32)*5/9;return{tempFahrenheit:r,tempCelsius:a}}function Ni(e){const{data:t,width:s,height:n}=e,r=[];r.push(`# Thermal data (Fahrenheit), ${s}x${n}`),r.push(Array.from({length:s},(a,o)=>`col_${o}`).join(","));for(let a=0;a<n;a++){const o=[];for(let l=0;l<s;l++)o.push(t[a*s+l].toFixed(2));r.push(o.join(","))}return r.join(`
`)}const Ti="/thermal-viewer-web/data";let ae=Ti;function Fi(e){ae=e,_e=null}let _e=null;async function Me(){if(_e)return _e;const e=`${ae}/manifest.json`,t=await fetch(e);if(!t.ok)throw new Error(`Failed to load manifest: ${t.status} from ${e}`);return _e=await t.json(),_e}function Ri(e){return{id:e.id,thermalPath:`${ae}/thermal/${e.id}.bin.gz`,visiblePath:e.hasVisible?`${ae}/visible/${e.id}.jpg`:"",thermalTiffPath:"",timestamp:e.timestamp,flightGroup:e.flightGroup,filename:e.filename,gps:e.gps,gimbalYaw:e.gimbalYaw,gimbalPitch:e.gimbalPitch,relativeAltitude:e.relativeAltitude}}async function Ei(){const e=await Me();return{images:e.images.map(Ri),totalCount:e.totalCount,flightGroups:e.flightGroups,photoGroups:e.photoGroups}}async function Oi(e){const s=(await Me()).images.find(r=>r.id===e);return s?s.stats:(await Re(e,ae)).stats}function ki(e){return`${ae}/thumbnails/${e}.jpg`}function Ai(e,t,s,n){return`${ae}/visible/${e}.jpg`}async function Mi(e){return Re(e,ae)}async function Pi(e,t,s){const n=await Re(e,ae),{tempCelsius:r,tempFahrenheit:a}=et(n,t,s);return{x:t,y:s,tempCelsius:r,tempFahrenheit:a}}async function Ii(e){const t=await Re(e,ae),s=Ni(t);return new Blob([s],{type:"text/csv"})}function Dt(e,t,s,n){const r=ct(e,t,s,n),a=document.createElement("canvas");return a.width=e.width,a.height=e.height,a.getContext("2d").putImageData(r,0,0),a}function Di(e,t,s,n,r,a,o,l){const h=l-30,u={data:new Float32Array(Array.from({length:256},(x,b)=>s+b/255*(n-s))),width:256,height:1},c=ct(u,t,s,n),d=document.createElement("canvas");d.width=256,d.height=1,d.getContext("2d").putImageData(c,0,0),e.save(),e.translate(r,a+h),e.rotate(-Math.PI/2),e.drawImage(d,0,0,256,1,0,0,h,o),e.restore(),e.fillStyle="#ffffff",e.font="bold 11px sans-serif",e.textAlign="center",e.fillText(`${n.toFixed(1)}F`,r+o/2,a-2),e.fillText(`${s.toFixed(1)}F`,r+o/2,a+l)}function tn(e,t,s,n,r){t.forEach(a=>{const o=n+a.x*s,l=r+a.y*s;e.strokeStyle="#ffff00",e.lineWidth=2,e.beginPath(),e.moveTo(o-8,l),e.lineTo(o+8,l),e.moveTo(o,l-8),e.lineTo(o,l+8),e.stroke();const h=`${a.tempF.toFixed(1)}F`;e.font="bold 11px sans-serif";const u=e.measureText(h).width;e.fillStyle="rgba(0,0,0,0.8)",e.fillRect(o+6,l-8,u+6,16),e.fillStyle="#ffff00",e.fillText(h,o+9,l+4)})}async function _i(e,t){const s=await Re(e,ae),n=t.colormap||"hot_iron",r=t.minTemp??s.stats.minTemp,a=t.maxTemp??s.stats.maxTemp,o=Dt(s,n,r,a),l=50,h=10,u=s.width+l+h,c=s.height,d=document.createElement("canvas");d.width=u,d.height=c;const x=d.getContext("2d");return x.fillStyle="#0a0a0a",x.fillRect(0,0,u,c),x.drawImage(o,0,0),Di(x,n,r,a,s.width+h,20,30,c-40),t.includeAnnotations&&t.markers&&t.markers.length>0&&tn(x,t.markers,1,0,0),new Promise((b,f)=>{d.toBlob(y=>y?b(y):f(new Error("Canvas export failed")),"image/png")})}function sn(e){return new Promise((t,s)=>{const n=new Image;n.crossOrigin="anonymous",n.onload=()=>t(n),n.onerror=s,n.src=e})}async function Li(e,t){const s=(await Ft(async()=>{const{default:S}=await import("./gif-D1HJ0RES.js").then(P=>P.g);return{default:S}},__vite__mapDeps([0,1,2]))).default,n=await Re(e,ae),r=t.colormap||"hot_iron",a=t.minTemp??n.stats.minTemp,o=t.maxTemp??n.stats.maxTemp,l=Math.min(t.fps,10),h=12,u=Dt(n,r,a,o),c=Math.round(n.width/2),d=Math.round(n.height/2),x=`${ae}/visible/${e}.jpg`;let b=null;try{b=await sn(x)}catch{}const f=new s({workers:2,quality:15,width:c,height:d,workerScript:"/thermal-viewer-web/gif.worker.js"}),y=document.createElement("canvas");y.width=c,y.height=d;const p=y.getContext("2d"),F=[];for(let S=0;S<h;S++){const P=S/(h-1);p.clearRect(0,0,c,d),b?(p.globalAlpha=1,p.drawImage(b,0,0,c,d),p.globalAlpha=P,p.drawImage(u,0,0,c,d),p.globalAlpha=1):p.drawImage(u,0,0,c,d),F.push(p.getImageData(0,0,c,d))}const T=Math.round(1e3/l),j=500;p.putImageData(F[0],0,0),f.addFrame(p,{copy:!0,delay:j});for(let S=1;S<h;S++)p.putImageData(F[S],0,0),f.addFrame(p,{copy:!0,delay:T});p.putImageData(F[h-1],0,0),f.addFrame(p,{copy:!0,delay:j});for(let S=h-2;S>0;S--)p.putImageData(F[S],0,0),f.addFrame(p,{copy:!0,delay:T});return new Promise(S=>{f.on("finished",P=>S(P)),f.render()})}async function $i(e){const{jsPDF:t}=await Ft(async()=>{const{jsPDF:o}=await import("./jspdf.es.min--zgcPOXB.js").then(l=>l.j);return{jsPDF:o}},__vite__mapDeps([3,1,2])),s=await Me(),n=new t({orientation:"landscape",unit:"mm",format:"letter"}),r=n.internal.pageSize.getWidth(),a=n.internal.pageSize.getHeight();for(let o=0;o<e.images.length;o++){const l=e.images[o];o>0&&n.addPage("letter","landscape");const h=await Re(l.imageId,ae),u=s.images.find(O=>O.id===l.imageId),c=l.colormap||"hot_iron",d=l.minTemp??h.stats.minTemp,x=l.maxTemp??h.stats.maxTemp;n.setFillColor(26,26,26),n.rect(0,0,r,a,"F"),n.setFontSize(16),n.setTextColor(255,102,0),n.text("AR Drone Ops  Thermal Inspection Report",10,12),n.setFontSize(9),n.setTextColor(180,180,180),n.text(`Image: ${u?.filename||l.imageId}`,10,19),n.text(`Date: ${u?.timestamp?new Date(u.timestamp).toLocaleString():"N/A"}`,10,24);let b=29;if(u?.gps&&(n.text(`GPS: ${u.gps.lat.toFixed(6)}, ${u.gps.lon.toFixed(6)}`,10,b),b+=5),u?.gimbalYaw!=null){const R=["N","NE","E","SE","S","SW","W","NW"][Math.round((u.gimbalYaw%360+360)%360/45)%8];n.text(`Direction: ${R} (${u.gimbalYaw.toFixed(0)})`,10,b),b+=5}u?.relativeAltitude!=null&&(n.text(`Altitude: ${(u.relativeAltitude*3.281).toFixed(0)} ft`,10,b),b+=5),n.setTextColor(255,102,0),n.text("Temperature Statistics:",10,b+2),n.setTextColor(200,200,200),b+=7,n.text(`Min: ${h.stats.minTemp.toFixed(1)}F`,10,b),n.text(`Max: ${h.stats.maxTemp.toFixed(1)}F`,50,b),n.text(`Mean: ${h.stats.meanTemp.toFixed(1)}F`,90,b);const f=Dt(h,c,d,x);if(l.markers&&l.markers.length>0){const O=f.getContext("2d");tn(O,l.markers,1,0,0)}const y=f.toDataURL("image/jpeg",.92),p=b+8,F=a-p-8,T=h.width/h.height;let j,S;const P=e.sideBySide&&u?.hasVisible,_=P?(r-30)/2:r-20;if(T>_/F?(j=_,S=j/T):(S=F,j=S*T),n.addImage(y,"JPEG",10,p,j,S),P)try{const O=await sn(`${ae}/visible/${l.imageId}.jpg`),R=document.createElement("canvas");R.width=O.width,R.height=O.height,R.getContext("2d").drawImage(O,0,0);const v=R.toDataURL("image/jpeg",.92);n.addImage(v,"JPEG",10+j+10,p,j,S)}catch{}{const O=r-18,R=p,v=6,k=S,E=50;for(let C=0;C<E;C++){const L=C/E,g=x-L*(x-d),D={data:new Float32Array([g]),width:1,height:1},q=ct(D,c,d,x);n.setFillColor(q.data[0],q.data[1],q.data[2]),n.rect(O,R+L*k,v,k/E+.5,"F")}n.setFontSize(7),n.setTextColor(255,255,255),n.text(`${x.toFixed(1)}F`,O,R-1),n.text(`${d.toFixed(1)}F`,O,R+k+4)}n.setFontSize(7),n.setTextColor(100,100,100),n.text("Generated by AR Drone Ops Thermal Viewer",10,a-3),n.text(`Page ${o+1} of ${e.images.length}`,r-40,a-3)}return n.output("blob")}async function Ui(){return(await Me()).mapData??null}async function Bi(){const e=await Me();return e.model3D?{...e.model3D,url:`${ae}/${e.model3D.url}`}:null}async function qi(){const e=await Me();return e.orthophoto?{...e.orthophoto,url:`${ae}/${e.orthophoto.url}`}:null}const ft=!0,Hi="/api";te.create({baseURL:Hi,timeout:3e4});async function zi(e){return Ei()}async function Qi(e){return Oi(e)}function Wi(e,t=2,s=0,n=0){return Ai(e)}function nn(e){return ki(e)}async function mt(e,t,s){return Pi(e,t,s)}async function Gi(e,t){return _i(e,t)}async function Vi(e,t){return Li(e,t)}async function Ki(e){return Ii(e)}async function Xi(e){return $i(e)}async function Yi(){return Ui()}async function Ji(){return Bi()}async function Zi(){return qi()}function tt(e,t){const s=URL.createObjectURL(e),n=document.createElement("a");n.href=s,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)}let Xe=null;const rn="/thermal-viewer-web/data";async function ea(){if(Xe)return Xe;const e=`${rn}/project.json`,t=await fetch(e);if(!t.ok)throw new Error(`Failed to load project config: ${t.status}`);return Xe=await t.json(),Xe}function ta(e){return`${rn}/buildings/${e}`}function an({isOpen:e,onClose:t,selectedImages:s,imageSettings:n}){const{colormap:r,displayMinTemp:a,displayMaxTemp:o,markers:l}=ye(),[h,u]=w.useState(!1),[c,d]=w.useState(!1),[x,b]=w.useState(null);if(!e)return null;const f=async()=>{if(s.length!==0){d(!0),b(null);try{const p=s.map(j=>{const S=n?.get(j.id),_=(S?.markers||l).map(O=>({x:O.x,y:O.y,tempF:O.tempFahrenheit??O.tempF??0}));return{imageId:j.id,colormap:S?.colormap||r,minTemp:S?.minTemp??a,maxTemp:S?.maxTemp??o,markers:_}}),F=await Xi({images:p,sideBySide:h,includeMetadata:!0,includeColorbar:!0}),T=s.length===1?`${s[0].filename.replace(/\.(tiff|jpg|JPG)$/i,"")}_report.pdf`:`thermal_report_${s.length}_images.pdf`;tt(F,T),t()}catch(p){console.error("PDF export failed:",p),b(p instanceof Error?p.message:"PDF export failed")}finally{d(!1)}}},y=s.some(p=>p.visiblePath);return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",children:i.jsxs("div",{className:"bg-[#2d2d2d] rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto shadow-2xl border border-[#444]",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[#444]",children:[i.jsxs("h2",{className:"text-lg font-bold text-white flex items-center gap-2",children:[i.jsx("span",{className:"text-2xl",children:""}),"Export PDF Report"]}),i.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white hover:bg-[#444] rounded-lg transition-all",children:""})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:"Selected Images"}),i.jsx("span",{className:"text-[#ff6600] font-bold",children:s.length})]}),s.length<=4?i.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(p=>i.jsx("span",{className:"text-xs bg-[#333] text-gray-300 px-2 py-1 rounded truncate max-w-[120px]",title:p.filename,children:p.filename.replace(/\.(tiff|jpg|JPG)$/i,"")},p.id))}):i.jsxs("p",{className:"text-xs text-gray-500",children:[s[0].filename.replace(/\.(tiff|jpg|JPG)$/i,"")," and ",s.length-1," more..."]})]}),i.jsx("div",{className:"space-y-3",children:i.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[#1a1a1a] rounded-lg cursor-pointer hover:bg-[#222] transition-colors",children:[i.jsx("input",{type:"checkbox",checked:h,onChange:p=>u(p.target.checked),disabled:!y,className:"w-5 h-5 rounded accent-[#ff6600]"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:"text-white text-sm font-medium",children:"Side-by-side with visible"}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:y?"Show thermal and visible images next to each other":"No visible images available for selected images"})]})]})}),i.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3 space-y-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:"Report includes:"}),i.jsxs("ul",{className:"text-xs text-gray-500 space-y-1 ml-4",children:[i.jsx("li",{children:" AR Drone Ops branding"}),i.jsx("li",{children:" Your colormap, temperature range, and markers"}),i.jsx("li",{children:" GPS coordinates, direction, altitude"}),i.jsx("li",{children:" Per-image temperature statistics (min/max/mean)"}),i.jsx("li",{children:" Temperature colorbar"})]})]}),x&&i.jsx("div",{className:"bg-red-600/20 border border-red-600/50 text-red-400 text-sm rounded-lg p-3",children:x})]}),i.jsxs("div",{className:"flex gap-3 p-4 border-t border-[#444]",children:[i.jsx("button",{onClick:t,className:"flex-1 py-3 text-sm bg-[#3d3d3d] hover:bg-[#4d4d4d] text-white rounded-lg transition-all font-medium",children:"Cancel"}),i.jsx("button",{onClick:f,disabled:c||s.length===0,className:"flex-1 py-3 text-sm bg-[#ff6600] hover:bg-[#ff8833] disabled:bg-[#555] disabled:text-gray-500 text-white rounded-lg transition-all font-medium",children:c?i.jsxs("span",{className:"flex items-center justify-center gap-2",children:[i.jsxs("svg",{className:"animate-spin w-4 h-4",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating PDF..."]}):`Export ${s.length} Image${s.length>1?"s":""}`})]})]})})}const ps=new Map;function sa({yaw:e,isRoof:t}){return t?i.jsxs("svg",{className:"w-5 h-5 text-[#ff6600]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 8v8M8 12l4 4 4-4"})]}):i.jsxs("svg",{className:"w-5 h-5 text-[#ff6600]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{transform:`rotate(${e}deg)`},children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("path",{d:"M12 8v8M8 12l4-4 4 4",fill:"currentColor"})]})}function gs({image:e,isSelected:t,isSelectionMode:s,isChecked:n,onClick:r,onToggleSelect:a}){const o=()=>{s?a():r()};return i.jsxs("button",{onClick:o,className:`thumbnail-card relative rounded overflow-hidden border-2 transition-all ${s&&n?"border-[#0066cc] ring-1 ring-[#0066cc]/50":t?"selected border-[#ff6600] ring-1 ring-[#ff6600]/50":"border-transparent hover:border-[#555]"}`,children:[i.jsx("img",{src:nn(e.id),alt:e.filename,className:"w-full h-20 object-cover bg-[#1a1a1a]",loading:"lazy"}),s&&i.jsx("div",{className:"absolute top-1 left-1",children:i.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${n?"bg-[#0066cc] border-[#0066cc]":"bg-black/50 border-white/60"}`,children:n&&i.jsx("svg",{className:"w-3 h-3 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})}),i.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 px-1 py-0.5",children:i.jsxs("span",{className:"text-[10px] text-white",children:["#",e.filename.match(/_(\d+)_T/)?.[1]||""]})})]})}function na({images:e,flightGroups:t,photoGroups:s,isLoading:n}){const{currentImage:r,setCurrentImage:a,clearMarkers:o}=ye(),[l,h]=w.useState("area"),[u,c]=w.useState(0),[d,x]=w.useState(!1),[b,f]=w.useState(new Set),[y,p]=w.useState(!1),F=v=>{f(k=>{const E=new Set(k);return E.has(v)?E.delete(v):E.add(v),E})},T=()=>{f(new Set(e.map(v=>v.id)))},j=()=>{f(new Set)},S=()=>{x(!1),f(new Set)},P=w.useMemo(()=>e.filter(v=>b.has(v.id)),[e,b]);w.useEffect(()=>{if(e.length===0)return;let v=!1;return(async()=>{for(let C=0;C<e.length&&!v;C+=6){const L=e.slice(C,C+6);await Promise.all(L.map(g=>ps.has(g.id)?Promise.resolve():new Promise(D=>{const q=new Image;q.onload=()=>{ps.set(g.id,q),D()},q.onerror=()=>D(),q.src=nn(g.id)}))),v||c(Math.min(100,Math.round((C+6)/e.length*100)))}})(),()=>{v=!0}},[e]);const _=w.useMemo(()=>{const v={};for(const k of e)v[k.id]=k;return v},[e]),O=w.useMemo(()=>{const v={};for(const k of e)v[k.flightGroup]||(v[k.flightGroup]=[]),v[k.flightGroup].push(k);return v},[e]),R=v=>{o(),a(v)};return n?i.jsx("div",{className:"p-4 h-full flex items-center justify-center",children:i.jsx("div",{className:"spinner"})}):i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b border-[#444]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h2",{className:"text-lg font-bold text-[#ff6600]",children:"Images"}),i.jsx("button",{onClick:()=>d?S():x(!0),className:`px-3 py-1.5 text-xs font-medium rounded-lg transition-all ${d?"bg-[#0066cc] text-white":"bg-[#3d3d3d] text-gray-300 hover:bg-[#4d4d4d]"}`,children:d?"Cancel":"Select"})]}),i.jsx("p",{className:"text-sm text-gray-400 mb-3",children:d?i.jsxs("span",{className:"text-[#0066cc]",children:[b.size," selected for PDF export"]}):i.jsxs(i.Fragment,{children:[e.length," thermal images",u<100&&i.jsxs("span",{className:"text-[#ff6600] ml-2",children:["(",u,"% cached)"]})]})}),d?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:T,className:"flex-1 px-3 py-1.5 text-xs font-medium rounded-lg bg-[#1a1a1a] text-gray-300 hover:bg-[#333] transition-all",children:"Select All"}),i.jsx("button",{onClick:j,disabled:b.size===0,className:"flex-1 px-3 py-1.5 text-xs font-medium rounded-lg bg-[#1a1a1a] text-gray-300 hover:bg-[#333] disabled:opacity-50 transition-all",children:"Clear"})]}):i.jsxs("div",{className:"flex gap-1 bg-[#1a1a1a] p-1 rounded-lg",children:[i.jsx("button",{onClick:()=>h("area"),className:`flex-1 px-3 py-1.5 text-xs font-medium rounded-md transition-all ${l==="area"?"bg-[#ff6600] text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-[#333]"}`,children:"By Area"}),i.jsx("button",{onClick:()=>h("flight"),className:`flex-1 px-3 py-1.5 text-xs font-medium rounded-md transition-all ${l==="flight"?"bg-[#ff6600] text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-[#333]"}`,children:"By Flight"})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto sidebar-scroll p-2",children:l==="area"?i.jsx(i.Fragment,{children:s.length>0?s.map(v=>i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"px-2 py-1 mb-2 flex items-center gap-2",children:[i.jsx(sa,{yaw:v.dominantYaw,isRoof:v.isRoofView}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-white",children:v.name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[v.imageIds.length," image",v.imageIds.length!==1?"s":""]})]})]}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.imageIds.map(k=>{const E=_[k];return E?i.jsx(gs,{image:E,isSelected:r?.id===k,isSelectionMode:d,isChecked:b.has(k),onClick:()=>R(E),onToggleSelect:()=>F(k)},k):null})})]},v.id)):i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("p",{children:"No photo groups found"}),i.jsx("p",{className:"text-xs mt-1",children:'Try switching to "By Flight" view'})]})}):t.map(v=>i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"px-2 py-1 mb-2",children:[i.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:v.replace("DJI_","Flight ")}),i.jsxs("p",{className:"text-xs text-gray-500",children:[O[v]?.length||0," images"]})]}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:O[v]?.map(k=>i.jsx(gs,{image:k,isSelected:r?.id===k.id,isSelectionMode:d,isChecked:b.has(k.id),onClick:()=>R(k),onToggleSelect:()=>F(k.id)},k.id))})]},v))}),i.jsx("div",{className:"p-3 border-t border-[#444] bg-[#252525]",children:d?i.jsx("button",{onClick:()=>p(!0),disabled:b.size===0,className:"w-full py-2.5 text-sm font-medium rounded-lg transition-all bg-[#0066cc] hover:bg-[#0077ee] disabled:bg-[#333] disabled:text-gray-500 text-white",children:b.size>0?`Export ${b.size} Image${b.size>1?"s":""} to PDF`:"Select images to export"}):i.jsx("p",{className:"text-xs text-gray-500 text-center",children:l==="area"?`${s.length} areas  ${e.length} images`:`${t.length} flights  ${e.length} images`})}),i.jsx(an,{isOpen:y,onClose:()=>{p(!1),S()},selectedImages:P})]})}const on=[{id:"white_hot",name:"White Hot",colors:["#000000","#FFFFFF"]},{id:"black_hot",name:"Black Hot",colors:["#FFFFFF","#000000"]},{id:"hot_iron",name:"Hot Iron",colors:["#000000","#330066","#660099","#990066","#CC3300","#FF6600","#FFCC33","#FFFFFF"]},{id:"fulgurite",name:"Fulgurite",colors:["#330000","#660000","#993300","#CC6600","#FF9933","#FFCC66","#FFFF99","#FFFFFF"]},{id:"medical",name:"Medical",colors:["#000033","#330066","#660099","#9900CC","#CC00FF","#FF66FF","#FFCCFF","#FFFFFF"]},{id:"arctic",name:"Arctic",colors:["#000066","#0033CC","#0099FF","#66CCFF","#CCFFFF","#FFFFFF"]},{id:"rainbow",name:"Rainbow",colors:["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"]},{id:"tint",name:"Tint",colors:["#000000","#333333","#666666","#999999","#FF0000","#FF3333","#FF6666"]}];function xs(e){const t=on.find(s=>s.id===e);return t?`linear-gradient(to right, ${t.colors.join(", ")})`:"linear-gradient(to right, #000, #fff)"}function be(e,t=1){return`${e.toFixed(t)}F`}const ys={white_hot:ra(),black_hot:ia(),hot_iron:aa(),fulgurite:oa(),medical:la(),arctic:ca(),rainbow:ua(),tint:da()};function We(e,t){const s=e.length,n=t/255*(s-1),r=Math.floor(n),a=Math.min(r+1,s-1),o=n-r;return[Math.round(e[r][0]+o*(e[a][0]-e[r][0])),Math.round(e[r][1]+o*(e[a][1]-e[r][1])),Math.round(e[r][2]+o*(e[a][2]-e[r][2]))]}function ra(){return Array.from({length:256},(e,t)=>[t,t,t])}function ia(){return Array.from({length:256},(e,t)=>[255-t,255-t,255-t])}function aa(){const e=[[0,0,0],[51,0,102],[102,0,153],[153,0,102],[204,51,0],[255,102,0],[255,204,51],[255,255,255]];return Array.from({length:256},(t,s)=>[...We(e,s)])}function oa(){const e=[[51,0,0],[102,0,0],[153,51,0],[204,102,0],[255,153,51],[255,204,102],[255,255,153],[255,255,255]];return Array.from({length:256},(t,s)=>[...We(e,s)])}function la(){const e=[[0,0,51],[51,0,102],[102,0,153],[153,0,204],[204,0,255],[255,102,255],[255,204,255],[255,255,255]];return Array.from({length:256},(t,s)=>[...We(e,s)])}function ca(){const e=[[0,0,102],[0,51,204],[0,153,255],[102,204,255],[204,255,255],[255,255,255]];return Array.from({length:256},(t,s)=>[...We(e,s)])}function ua(){const e=[[0,0,255],[0,255,255],[0,255,0],[255,255,0],[255,0,0]];return Array.from({length:256},(t,s)=>[...We(e,s)])}function da(){const e=[];for(let t=0;t<256;t++)if(t<200){const s=Math.round(t/200*180);e.push([s,s,s])}else{const s=(t-200)/55,n=Math.round(180+s*75),r=Math.round(180*(1-s*.8)),a=Math.round(180*(1-s*.8));e.push([n,r,a])}return e}function ha(){const e=w.useRef(null),t=w.useRef(null),{currentImage:s,viewMode:n,colormap:r,opacity:a,minTemp:o,maxTemp:l,displayMinTemp:h,displayMaxTemp:u,markers:c,hoverTemp:d,zoom:x,panX:b,panY:f,thermalZoom:y,alignOffsetX:p,alignOffsetY:F,setThermalStats:T,addMarker:j,setHoverTemp:S,setLoading:P}=ye(),[_,O]=w.useState(!1),[R,v]=w.useState(null),[k,E]=w.useState(null);w.useRef(null);const[C,L]=w.useState(null);w.useEffect(()=>{s&&(P(!0),Qi(s.id).then(T).catch(console.error).finally(()=>P(!1)))},[s,T,P]),w.useEffect(()=>{s&&(O(!1),L(null),Mi(s.id).then($=>{L($),O(!0)}).catch($=>{console.error("Failed to load static thermal data:",$),O(!0)}))},[s]),w.useEffect(()=>{},[s,o,l]),w.useEffect(()=>{if(!s)return;const $=n==="visible"||n==="overlay"||n==="split";if($){const N=Wi(s.id,y,p,F),G=new Image;G.crossOrigin="anonymous",G.onload=()=>E(G),G.onerror=()=>console.error("Failed to load visible image"),G.src=N}else!$&&k&&E(null)},[s,n,y,p,F]);const g=w.useMemo(()=>{if(C)return ct(C,r,h,u);if(!R)return null;const{width:$,height:N,data:G}=R,B=new ImageData($,N),Q=ys[r]||ys.hot_iron,V=l-o,z=u-h,K=h-o;for(let X=0;X<G.length;X+=4){let U=G[X]/255*V;U=(U-K)/z,U=Math.max(0,Math.min(1,U));const W=Math.round(U*255),[J,A,I]=Q[W];B.data[X]=J,B.data[X+1]=A,B.data[X+2]=I,B.data[X+3]=255}return B},[R,C,r,o,l,h,u]);w.useEffect(()=>{if(!e.current||!t.current||!g)return;const $=e.current,N=$.getContext("2d");if(!N)return;const G=t.current,B=G.clientWidth,Q=G.clientHeight;$.width=B,$.height=Q,N.fillStyle="#0a0a0a",N.fillRect(0,0,$.width,$.height);const V=g.width,z=g.height,K=V/z,X=B/Q;let H,U;if(n==="split"){const W=B/2,J=W/Q;K>J?(H=W*x,U=H/K):(U=Q*x,H=U*K);const A=(W-H)/2+b,I=(Q-U)/2+f,Z=W+(W-H)/2+b,re=I,ee=document.createElement("canvas");ee.width=V,ee.height=z;const se=ee.getContext("2d");se&&(se.putImageData(g,0,0),N.drawImage(ee,A,I,H,U)),k&&N.drawImage(k,Z,re,H,U),N.strokeStyle="#ff6600",N.lineWidth=2,N.beginPath(),N.moveTo(B/2,0),N.lineTo(B/2,Q),N.stroke(),N.fillStyle="rgba(0,0,0,0.7)",N.fillRect(10,10,70,24),N.fillRect(B/2+10,10,60,24),N.fillStyle="#ff6600",N.font='bold 12px "Gravesend Sans", sans-serif',N.fillText("THERMAL",15,26),N.fillText("VISIBLE",B/2+15,26)}else{K>X?(H=B*x,U=H/K):(U=Q*x,H=U*K);const W=(B-H)/2+b,J=(Q-U)/2+f;if(n==="thermal"){const A=document.createElement("canvas");A.width=V,A.height=z;const I=A.getContext("2d");I&&(I.putImageData(g,0,0),N.drawImage(A,W,J,H,U))}else if(n==="visible"&&k)N.drawImage(k,W,J,H,U);else if(n==="overlay"&&k){N.drawImage(k,W,J,H,U),N.globalAlpha=a;const A=document.createElement("canvas");A.width=V,A.height=z;const I=A.getContext("2d");I&&(I.putImageData(g,0,0),N.drawImage(A,W,J,H,U)),N.globalAlpha=1}else{const A=document.createElement("canvas");A.width=V,A.height=z;const I=A.getContext("2d");I&&(I.putImageData(g,0,0),N.drawImage(A,W,J,H,U))}if(c.forEach(A=>{const I=W+A.x/V*H,Z=J+A.y/z*U;N.strokeStyle="#ffff00",N.lineWidth=2,N.beginPath(),N.moveTo(I-10,Z),N.lineTo(I+10,Z),N.moveTo(I,Z-10),N.lineTo(I,Z+10),N.stroke(),N.beginPath(),N.arc(I,Z,8,0,Math.PI*2),N.stroke();const re=be(A.tempFahrenheit);N.font='bold 12px "Gravesend Sans", sans-serif';const ee=N.measureText(re).width;N.fillStyle="rgba(0, 0, 0, 0.8)",N.fillRect(I+12,Z-8,ee+8,18),N.fillStyle="#ffff00",N.fillText(re,I+16,Z+5)}),d){const A=W+d.x/V*H,I=J+d.y/z*U;N.strokeStyle="rgba(255, 255, 255, 0.5)",N.lineWidth=1,N.beginPath(),N.moveTo(A-5,I),N.lineTo(A+5,I),N.moveTo(A,I-5),N.lineTo(A,I+5),N.stroke()}}},[g,k,n,a,x,b,f,c,d]);const D=w.useCallback(async $=>{if(!e.current||!t.current||!s||!g||n==="split")return;const G=e.current.getBoundingClientRect(),B=$.clientX-G.left,Q=$.clientY-G.top,V=t.current,z=V.clientWidth,K=V.clientHeight,X=g.width,H=g.height,U=X/H,W=z/K;let J,A;U>W?(J=z*x,A=J/U):(A=K*x,J=A*U);const I=(z-J)/2+b,Z=(K-A)/2+f;if(B<I||B>I+J||Q<Z||Q>Z+A)return;const re=Math.floor((B-I)/J*X),ee=Math.floor((Q-Z)/A*H);try{if(ft&&C){const{tempCelsius:se,tempFahrenheit:ce}=et(C,re,ee),Pe={id:`marker-${Date.now()}`,x:re,y:ee,tempCelsius:se,tempFahrenheit:ce};j(Pe)}else{const se=await mt(s.id,re,ee),ce={id:`marker-${Date.now()}`,x:re,y:ee,tempCelsius:se.tempCelsius,tempFahrenheit:se.tempFahrenheit};j(ce)}}catch(se){console.error("Failed to get temperature:",se)}},[s,g,C,n,x,b,f,j]),q=w.useRef(0),le=w.useCallback(async $=>{const N=Date.now();if(N-q.current<100||(q.current=N,!e.current||!t.current||!s||!g)||n==="split")return;const B=e.current.getBoundingClientRect(),Q=$.clientX-B.left,V=$.clientY-B.top,z=t.current,K=z.clientWidth,X=z.clientHeight,H=g.width,U=g.height,W=H/U,J=K/X;let A,I;W>J?(A=K*x,I=A/W):(I=X*x,A=I*W);const Z=(K-A)/2+b,re=(X-I)/2+f;if(Q<Z||Q>Z+A||V<re||V>re+I){S(null);return}const ee=Math.floor((Q-Z)/A*H),se=Math.floor((V-re)/I*U);try{if(ft&&C){const{tempFahrenheit:ce}=et(C,ee,se);S({x:ee,y:se,tempF:ce})}else{const ce=await mt(s.id,ee,se);S({x:ee,y:se,tempF:ce.tempFahrenheit})}}catch{S(null)}},[s,g,C,n,x,b,f,S]),Y=()=>S(null),fe=w.useCallback($=>{$.preventDefault(),ye.getState().clearMarkers()},[]),ve=w.useCallback(async $=>{if(!e.current||!t.current||!s||!g||n==="split")return;$.preventDefault();const N=$.changedTouches[0],B=e.current.getBoundingClientRect(),Q=N.clientX-B.left,V=N.clientY-B.top,z=t.current,K=z.clientWidth,X=z.clientHeight,H=g.width,U=g.height,W=H/U,J=K/X;let A,I;W>J?(A=K*x,I=A/W):(I=X*x,A=I*W);const Z=(K-A)/2+b,re=(X-I)/2+f;if(Q<Z||Q>Z+A||V<re||V>re+I)return;const ee=Math.floor((Q-Z)/A*H),se=Math.floor((V-re)/I*U);try{if(ft&&C){const{tempCelsius:ce,tempFahrenheit:Pe}=et(C,ee,se),ln={id:`marker-${Date.now()}`,x:ee,y:se,tempCelsius:ce,tempFahrenheit:Pe};j(ln)}else{const ce=await mt(s.id,ee,se),Pe={id:`marker-${Date.now()}`,x:ee,y:se,tempCelsius:ce.tempCelsius,tempFahrenheit:ce.tempFahrenheit};j(Pe)}}catch(ce){console.error("Failed to get temperature:",ce)}},[s,g,C,n,x,b,f,j]),ne=ye($=>$.thermalStats);return i.jsxs("div",{ref:t,className:"canvas-container",children:[i.jsx("canvas",{ref:e,onClick:D,onMouseMove:le,onMouseLeave:Y,onContextMenu:fe,onTouchEnd:ve,className:"cursor-crosshair touch-none"}),_&&ne&&i.jsx("div",{className:"absolute top-4 right-4 bg-black/85 backdrop-blur-sm text-white px-3 py-2 rounded-lg shadow-lg",children:i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center justify-between gap-4",children:[i.jsx("span",{className:"text-blue-400 font-bold text-xs",children:"MIN"}),i.jsx("span",{className:"font-mono text-sm",children:be(ne.minTemp)})]}),i.jsxs("div",{className:"flex items-center justify-between gap-4",children:[i.jsx("span",{className:"text-red-400 font-bold text-xs",children:"MAX"}),i.jsx("span",{className:"font-mono text-sm",children:be(ne.maxTemp)})]}),i.jsxs("div",{className:"flex items-center justify-between gap-4 text-gray-400 text-xs border-t border-gray-600 pt-1 mt-1",children:[i.jsx("span",{children:"AVG"}),i.jsx("span",{className:"font-mono",children:be(ne.meanTemp)})]})]})}),d&&i.jsxs("div",{className:"absolute top-4 left-4 bg-black/85 backdrop-blur-sm text-white px-3 py-2 rounded-lg shadow-lg hidden md:block",children:[i.jsx("span",{className:"text-[#ff6600] font-bold text-lg",children:be(d.tempF)}),i.jsxs("span",{className:"text-gray-400 text-sm ml-2",children:["(",d.x,", ",d.y,")"]})]}),c.length>0&&n!=="split"&&i.jsx("div",{className:"absolute bottom-4 right-4 flex flex-col gap-2 md:hidden",children:i.jsxs("button",{onClick:()=>ye.getState().clearMarkers(),className:"bg-red-600/90 backdrop-blur-sm text-white px-4 py-3 rounded-full shadow-lg flex items-center gap-2 active:scale-95 transition-transform",children:[i.jsx("span",{children:""}),i.jsxs("span",{className:"text-sm font-medium",children:["Clear (",c.length,")"]})]})}),c.length>0&&n!=="split"&&i.jsxs("div",{className:"absolute bottom-4 left-4 bg-black/80 text-white px-3 py-2 rounded-lg text-sm hidden md:block",children:[c.length," marker",c.length!==1?"s":"","  Right-click to clear"]}),c.length===0&&_&&n!=="split"&&i.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/70 backdrop-blur-sm text-gray-200 px-4 py-2 rounded-full text-sm md:hidden shadow-lg",children:" Tap to add temperature marker"}),!_&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:i.jsx("div",{className:"spinner"})})]})}function je({title:e,children:t,defaultOpen:s=!0,badge:n}){const[r,a]=w.useState(s);return i.jsxs("section",{className:"border-b border-[#444] last:border-0",children:[i.jsxs("button",{onClick:()=>a(!r),className:"w-full flex items-center justify-between py-3 px-1 text-left",children:[i.jsxs("span",{className:"text-sm font-bold text-[#ff6600] flex items-center gap-2",children:[e,n!==void 0&&i.jsx("span",{className:"bg-[#ff6600] text-white text-xs px-1.5 py-0.5 rounded-full",children:n})]}),i.jsx("span",{className:"text-gray-500 text-lg",children:r?"":"+"})]}),r&&i.jsx("div",{className:"pb-4",children:t})]})}function fa(){const{currentImage:e,thermalStats:t,colormap:s,opacity:n,minTemp:r,maxTemp:a,displayMinTemp:o,displayMaxTemp:l,markers:h,thermalZoom:u,alignOffsetX:c,alignOffsetY:d,setColormap:x,setOpacity:b,setDisplayTempRange:f,clearMarkers:y,removeMarker:p,resetView:F,setThermalZoom:T,setAlignOffset:j}=ye(),S=async()=>{if(e)try{const g=await Gi(e.id,{format:"png",colormap:s,minTemp:o,maxTemp:l,includeAnnotations:h.length>0,includeColorbar:!0,markers:h.map(D=>({x:D.x,y:D.y,tempF:D.tempFahrenheit}))});tt(g,`${e.filename.replace(".tiff","")}_thermal.png`)}catch(g){console.error("Export failed:",g)}},P=async()=>{if(e)try{const g=await Ki(e.id);tt(g,`${e.filename.replace(".tiff","")}_temps.csv`)}catch(g){console.error("CSV export failed:",g)}},[_,O]=w.useState(!1),[R,v]=w.useState(""),[k,E]=w.useState(!1),C=e?.visiblePath!=null,L=async()=>{if(e){if(!C){alert("No visible image available for this thermal image. GIF export requires both thermal and visible images.");return}O(!0),v("Generating frames...");try{const g=await Vi(e.id,{colormap:s,minTemp:o,maxTemp:l,duration:5,fps:12,thermalZoom:u,offsetX:c,offsetY:d});if(!g||g.size===0)throw new Error("Received empty response from server");v("Saving...");const D=e.filename.replace(".tiff","").replace(".JPG","").replace(".jpg","")+"_thermal_visible.gif";tt(g,D),v("Done!"),setTimeout(()=>v(""),2e3)}catch(g){console.error("GIF export failed:",g);const D=g instanceof Error?g.message:"Unknown error";alert(`GIF export failed: ${D}`),v("")}finally{O(!1)}}};return i.jsxs("div",{className:"p-4 space-y-0",children:[i.jsx(je,{title:"Color Palette",defaultOpen:!0,children:i.jsx("div",{className:"grid grid-cols-4 gap-2",children:on.map(g=>i.jsxs("button",{onClick:()=>x(g.id),className:`relative rounded-lg overflow-hidden border-2 transition-all ${s===g.id?"border-[#ff6600] ring-2 ring-[#ff6600]/50 scale-105":"border-transparent hover:border-[#555] active:scale-95"}`,children:[i.jsx("div",{className:"h-8",style:{background:xs(g.id)}}),i.jsx("div",{className:"bg-[#2d2d2d] px-1 py-1",children:i.jsx("span",{className:"text-[10px] text-gray-300 block truncate",children:g.name})})]},g.id))})}),i.jsx(je,{title:"Temperature Range",defaultOpen:!0,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"h-6 rounded-lg",style:{background:xs(s)}}),t&&i.jsx("div",{className:"absolute top-0 h-6 border-l-2 border-r-2 border-white/80 pointer-events-none rounded",style:{left:`${(o-r)/(a-r)*100}%`,right:`${100-(l-r)/(a-r)*100}%`}})]}),i.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[i.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[i.jsx("span",{className:"text-blue-400 font-bold",children:"MIN"}),i.jsx("span",{className:"text-blue-400 font-mono text-base",children:be(o)})]}),i.jsx("input",{type:"range",min:r,max:a,step:.5,value:o,onChange:g=>f(parseFloat(g.target.value),l),className:"w-full h-8 appearance-none bg-transparent cursor-pointer touch-pan-y",style:{WebkitAppearance:"none"}})]}),i.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[i.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[i.jsx("span",{className:"text-red-400 font-bold",children:"MAX"}),i.jsx("span",{className:"text-red-400 font-mono text-base",children:be(l)})]}),i.jsx("input",{type:"range",min:r,max:a,step:.5,value:l,onChange:g=>f(o,parseFloat(g.target.value)),className:"w-full h-8 appearance-none bg-transparent cursor-pointer touch-pan-y"})]}),i.jsx("button",{onClick:()=>f(r,a),className:"w-full py-3 text-sm text-gray-400 hover:text-white active:bg-[#4d4d4d] bg-[#3d3d3d] rounded-lg transition-all",children:"Reset to Auto Range"})]})}),i.jsx(je,{title:"Overlay Blend",defaultOpen:!0,children:i.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("span",{className:"text-gray-400 text-sm",children:"Thermal Visibility"}),i.jsxs("span",{className:"text-[#ff6600] font-mono text-lg font-bold",children:[Math.round(n*100),"%"]})]}),i.jsx("input",{type:"range",min:0,max:1,step:.05,value:n,onChange:g=>b(parseFloat(g.target.value)),className:"w-full h-10 appearance-none bg-transparent cursor-pointer touch-pan-y"}),i.jsx("div",{className:"flex gap-2 mt-3",children:[.25,.5,.75].map(g=>i.jsxs("button",{onClick:()=>b(g),className:`flex-1 py-2 text-xs rounded-lg transition-all ${Math.abs(n-g)<.05?"bg-[#ff6600] text-white":"bg-[#3d3d3d] text-gray-400 active:bg-[#4d4d4d]"}`,children:[Math.round(g*100),"%"]},g))})]})}),i.jsx(je,{title:"Alignment",defaultOpen:!1,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-xs text-gray-500 -mt-2 mb-2",children:"Adjust to align thermal overlay with visible image"}),i.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[i.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[i.jsx("span",{className:"text-gray-400",children:"Visible Crop Zoom"}),i.jsxs("span",{className:"text-white font-mono text-base",children:[u.toFixed(2),"x"]})]}),i.jsx("input",{type:"range",min:1,max:4,step:.05,value:u,onChange:g=>T(parseFloat(g.target.value)),className:"w-full h-8"}),i.jsx("div",{className:"flex gap-2 mt-2",children:[1,1.5,2,2.5].map(g=>i.jsxs("button",{onClick:()=>T(g),className:`flex-1 py-1.5 text-xs rounded transition-all ${Math.abs(u-g)<.05?"bg-[#ff6600] text-white":"bg-[#3d3d3d] text-gray-400"}`,children:[g,"x"]},g))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[i.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[i.jsx("span",{className:"text-gray-400",children:"X Offset"}),i.jsxs("span",{className:"text-white font-mono",children:[c,"px"]})]}),i.jsx("input",{type:"range",min:-150,max:150,step:1,value:c,onChange:g=>j(parseInt(g.target.value),d),className:"w-full h-6"}),i.jsxs("div",{className:"flex gap-1 mt-2",children:[i.jsx("button",{onClick:()=>j(c-10,d),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded",children:"-10"}),i.jsx("button",{onClick:()=>j(c-1,d),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded",children:"-1"}),i.jsx("button",{onClick:()=>j(0,d),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded text-[#ff6600]",children:"0"}),i.jsx("button",{onClick:()=>j(c+1,d),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded",children:"+1"}),i.jsx("button",{onClick:()=>j(c+10,d),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded",children:"+10"})]})]}),i.jsxs("div",{className:"bg-[#1a1a1a] rounded-lg p-3",children:[i.jsxs("div",{className:"flex justify-between text-xs mb-2",children:[i.jsx("span",{className:"text-gray-400",children:"Y Offset"}),i.jsxs("span",{className:"text-white font-mono",children:[d,"px"]})]}),i.jsx("input",{type:"range",min:-150,max:150,step:1,value:d,onChange:g=>j(c,parseInt(g.target.value)),className:"w-full h-6"}),i.jsxs("div",{className:"flex gap-1 mt-2",children:[i.jsx("button",{onClick:()=>j(c,d-10),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded",children:"-10"}),i.jsx("button",{onClick:()=>j(c,d-1),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded",children:"-1"}),i.jsx("button",{onClick:()=>j(c,0),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded text-[#ff6600]",children:"0"}),i.jsx("button",{onClick:()=>j(c,d+1),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded",children:"+1"}),i.jsx("button",{onClick:()=>j(c,d+10),className:"flex-1 py-1 text-xs bg-[#3d3d3d] rounded",children:"+10"})]})]})]}),i.jsx("button",{onClick:()=>{T(1),j(0,0)},className:"w-full py-3 text-sm text-gray-400 hover:text-white active:bg-[#4d4d4d] bg-[#3d3d3d] rounded-lg",children:"Reset Alignment"})]})}),h.length>0&&i.jsx(je,{title:"Markers",badge:h.length,defaultOpen:!0,children:i.jsxs("div",{className:"space-y-2",children:[i.jsx("button",{onClick:y,className:"w-full py-3 text-sm bg-red-600/20 text-red-400 hover:bg-red-600/30 active:bg-red-600/40 rounded-lg border border-red-600/30 transition-all",children:" Clear All Markers"}),i.jsx("div",{className:"bg-[#1a1a1a] rounded-lg overflow-hidden max-h-48 overflow-y-auto",children:h.map((g,D)=>i.jsxs("div",{className:"flex justify-between items-center px-3 py-3 border-b border-[#333] last:border-0",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"w-6 h-6 rounded-full bg-yellow-500/20 text-yellow-400 text-xs flex items-center justify-center font-bold",children:D+1}),i.jsx("span",{className:"text-lg font-mono text-[#ff6600] font-bold",children:be(g.tempFahrenheit)})]}),i.jsx("button",{onClick:()=>p(g.id),className:"w-8 h-8 flex items-center justify-center text-gray-500 hover:text-red-400 hover:bg-red-500/20 rounded-full transition-all",children:""})]},g.id))})]})}),i.jsx(je,{title:"Export",defaultOpen:!1,children:i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:S,disabled:!e,className:"w-full py-4 text-sm bg-[#ff6600] hover:bg-[#ff8833] active:bg-[#e65c00] disabled:bg-[#555] disabled:text-gray-500 text-white rounded-lg transition-all font-medium",children:" Export Image (PNG)"}),i.jsx("button",{onClick:L,disabled:!e||_||!C,className:"w-full py-4 text-sm bg-[#6b21a8] hover:bg-[#7c3aed] active:bg-[#581c87] disabled:bg-[#555] disabled:text-gray-500 text-white rounded-lg transition-all font-medium",children:_?` ${R||"Processing..."}`:" Export Animated GIF"}),i.jsx("p",{className:"text-xs text-gray-500 -mt-1 px-1",children:C?"5-second loop fading between thermal & visible":" No visible image - GIF export unavailable"}),i.jsx("button",{onClick:P,disabled:!e,className:"w-full py-4 text-sm bg-[#3d3d3d] hover:bg-[#4d4d4d] active:bg-[#555] disabled:bg-[#333] disabled:text-gray-500 text-white rounded-lg transition-all font-medium",children:" Export Temperature CSV"}),i.jsx("button",{onClick:()=>E(!0),disabled:!e,className:"w-full py-4 text-sm bg-[#0066cc] hover:bg-[#0077ee] active:bg-[#0055aa] disabled:bg-[#333] disabled:text-gray-500 text-white rounded-lg transition-all font-medium",children:" Export PDF Report"}),i.jsx("p",{className:"text-xs text-gray-500 -mt-1 px-1",children:"Professional report with metadata, colorbar, and markers"})]})}),i.jsx(je,{title:"View Controls",defaultOpen:!1,children:i.jsx("button",{onClick:F,className:"w-full py-3 text-sm bg-[#3d3d3d] hover:bg-[#4d4d4d] active:bg-[#555] text-white rounded-lg transition-all",children:"Reset Zoom & Pan"})}),i.jsxs("div",{className:"text-xs text-gray-500 space-y-1.5 pt-4 border-t border-[#444]",children:[i.jsxs("p",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-base",children:""}),i.jsx("span",{children:"Tap image to add temperature marker"})]}),i.jsxs("p",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-base",children:""}),i.jsx("span",{children:'Use "Clear All Markers" button above'})]})]}),i.jsx(an,{isOpen:k,onClose:()=>E(!1),selectedImages:e?[e]:[]})]})}const bs={"North Face":"#ef4444","South Face":"#3b82f6","East Face":"#22c55e","West Face":"#eab308","Roof View":"#a855f7"},ma="#6b7280",xe=[[0,0,0],[51,0,102],[102,0,153],[153,0,102],[204,51,0],[255,102,0],[255,204,51],[255,255,255]];function pa(){const e=[],t=xe.length;for(let s=0;s<256;s++){const n=s/255*(t-1),r=Math.floor(n),a=Math.min(r+1,t-1),o=n-r;e.push([Math.round(xe[r][0]+o*(xe[a][0]-xe[r][0])),Math.round(xe[r][1]+o*(xe[a][1]-xe[r][1])),Math.round(xe[r][2]+o*(xe[a][2]-xe[r][2]))])}return e}const pt=pa();function ga(e,t,s){let n=0,r=1/0;for(let a=0;a<256;a++){const o=e-pt[a][0],l=t-pt[a][1],h=s-pt[a][2],u=o*o+l*l+h*h;u<r&&(r=u,n=a)}return n/255}function xa(e,t,s){const n=s?40:30,r=s?3:2;return`
    <svg xmlns="http://www.w3.org/2000/svg" width="${n}" height="${n}" viewBox="0 0 40 40">
      <g transform="rotate(${e}, 20, 20)" opacity="${s?1:.85}">
        <polygon points="20,4 28,22 20,18 12,22" fill="${t}" stroke="#fff" stroke-width="${r}"/>
        <circle cx="20" cy="24" r="6" fill="${t}" stroke="#fff" stroke-width="${r}"/>
        ${s?'<circle cx="20" cy="24" r="3" fill="#fff"/>':""}
      </g>
    </svg>
  `}function ya(e,t){const o=(e-30.5-90)*Math.PI/180,l=(e+30.5-90)*Math.PI/180,h=40+60*Math.cos(o),u=40+60*Math.sin(o),c=40+60*Math.cos(l),d=40+60*Math.sin(l);return`
    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80">
      <polygon points="40,40 ${h},${u} ${c},${d}" fill="${t}" opacity="0.2" stroke="${t}" stroke-width="1" stroke-opacity="0.4"/>
    </svg>
  `}function ba({images:e,photoGroups:t,mapData:s,orthophoto:n}){const r=w.useRef(null),a=w.useRef(null),o=w.useRef([]),l=w.useRef([]),h=w.useRef(null),u=w.useRef(null),c=w.useRef(null),d=w.useRef(null),[x,b]=w.useState(!1),[f,y]=w.useState(!1),[p,F]=w.useState(!0),[T,j]=w.useState(.7),[S,P]=w.useState(null),{currentImage:_,setCurrentImage:O}=ye(),R=s?.markers||e.filter(E=>E.gps?.lat&&E.gps?.lon).map(E=>{let C="Unknown";for(const L of t)if(L.imageIds.includes(E.id)){C=L.name;break}return{imageId:E.id,lat:E.gps.lat,lon:E.gps.lon,yaw:E.gimbalYaw??0,pitch:E.gimbalPitch??0,altitude:E.relativeAltitude??0,facadeGroup:C}}),v=s?.center||(()=>{if(R.length===0)return{lat:42.34,lon:-71.12};const E=R.reduce((L,g)=>L+g.lat,0)/R.length,C=R.reduce((L,g)=>L+g.lon,0)/R.length;return{lat:E,lon:C}})();w.useEffect(()=>{if(!r.current||a.current)return;const E=()=>{if(!window.google?.maps){setTimeout(E,200);return}const C=new google.maps.Map(r.current,{center:{lat:v.lat,lng:v.lon},zoom:19,mapTypeId:"satellite",tilt:0,mapId:"thermal-viewer-map",gestureHandling:"greedy"});a.current=C,d.current=new google.maps.InfoWindow,b(!0)};E()},[v.lat,v.lon]),w.useEffect(()=>{if(!x||!a.current||!n)return;const E=a.current;if(h.current&&(h.current.setMap(null),h.current=null),!p)return;const C=new google.maps.LatLngBounds({lat:n.bounds.south,lng:n.bounds.west},{lat:n.bounds.north,lng:n.bounds.east}),L=new google.maps.GroundOverlay(n.url,C,{opacity:T,clickable:!0});L.setMap(E),h.current=L;const g=new Image;return g.crossOrigin="anonymous",g.onload=()=>{c.current=g;const D=document.createElement("canvas");D.width=g.width,D.height=g.height,D.getContext("2d").drawImage(g,0,0),u.current=D},g.src=n.url,L.addListener("click",D=>{if(!u.current||!D.latLng)return;const q=D.latLng.lat(),le=D.latLng.lng(),Y=u.current,fe=n.bounds,ve=(le-fe.west)/(fe.east-fe.west)*Y.width,ne=(fe.north-q)/(fe.north-fe.south)*Y.height;if(ve<0||ve>=Y.width||ne<0||ne>=Y.height)return;const N=Y.getContext("2d").getImageData(Math.floor(ve),Math.floor(ne),1,1).data,[G,B,Q]=N;if(N[3]<128||G===0&&B===0&&Q===0){P(null);return}const V=ga(G,B,Q),z=n.tempRange,K=z.minTempF+V*(z.maxTempF-z.minTempF),X=z.minTempC+V*(z.maxTempC-z.minTempC);P({lat:q,lon:le,tempF:K,tempC:X}),d.current?.setContent(`
        <div style="font-family: sans-serif; font-size: 14px; color: #333; min-width: 120px;">
          <div style="font-weight: bold; font-size: 18px; color: #ff6600; margin-bottom: 4px;">
            ${K.toFixed(1)}F
          </div>
          <div style="color: #666;">${X.toFixed(1)}C</div>
        </div>
      `),d.current?.setPosition(D.latLng),d.current?.open(E)}),()=>{L.setMap(null)}},[x,n,p,T]),w.useEffect(()=>{h.current&&h.current.setOpacity(T)},[T]),w.useEffect(()=>{if(!x||!a.current)return;const E=a.current;o.current.forEach(C=>C.map=null),o.current=[],l.current.forEach(C=>C.map=null),l.current=[],R.forEach(C=>{const L=_?.id===C.imageId,g=bs[C.facadeGroup]||ma,D=document.createElement("div");D.innerHTML=xa(C.yaw,g,L),D.style.cursor="pointer",D.style.transition="transform 0.15s ease",L&&(D.style.zIndex="10",D.style.filter="drop-shadow(0 0 6px rgba(255,255,255,0.8))");const q=new google.maps.marker.AdvancedMarkerElement({map:E,position:{lat:C.lat,lng:C.lon},content:D,title:`${C.facadeGroup}  ${C.imageId}`,zIndex:L?100:1});if(q.addListener("click",()=>{const le=e.find(Y=>Y.id===C.imageId);le&&O(le)}),D.addEventListener("mouseenter",()=>{const Y=["N","NE","E","SE","S","SW","W","NW"][Math.round((C.yaw%360+360)%360/45)%8],fe=(C.altitude*3.281).toFixed(0);d.current?.setContent(`
          <div style="font-family: sans-serif; font-size: 13px; color: #333; min-width: 140px;">
            <div style="font-weight: bold; margin-bottom: 4px;">${C.facadeGroup}</div>
            <div>Direction: ${Y} (${C.yaw.toFixed(0)})</div>
            <div>Altitude: ${fe} ft</div>
            <div>Pitch: ${C.pitch.toFixed(0)}</div>
            <div style="color: #888; font-size: 11px; margin-top: 4px;">Click to view</div>
          </div>
        `),d.current?.open(E,q)}),D.addEventListener("mouseleave",()=>{d.current?.close()}),o.current.push(q),f){const le=document.createElement("div");le.innerHTML=ya(C.yaw,g),le.style.pointerEvents="none";const Y=new google.maps.marker.AdvancedMarkerElement({map:E,position:{lat:C.lat,lng:C.lon},content:le,zIndex:0});l.current.push(Y)}})},[x,R,_?.id,e,O,f]),w.useEffect(()=>{!a.current||!_?.gps||a.current.panTo({lat:_.gps.lat,lng:_.gps.lon})},[_?.id,_?.gps]);const k=!!n;return i.jsxs("div",{className:"relative w-full h-full",children:[i.jsx("div",{ref:r,className:"w-full h-full"}),!x&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#1a1a1a]",children:i.jsxs("div",{className:"text-center text-gray-500",children:[i.jsx("div",{className:"spinner mb-4"}),i.jsx("p",{children:"Loading Google Maps..."})]})}),i.jsxs("div",{className:"absolute bottom-4 left-4 bg-[#2d2d2d]/90 backdrop-blur-sm rounded-lg p-3 text-xs text-gray-300 z-10",children:[i.jsx("div",{className:"font-bold text-white mb-2",children:"Photo Locations"}),Object.entries(bs).map(([E,C])=>i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:C}}),i.jsx("span",{children:E})]},E)),i.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-600 space-y-2",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:f,onChange:E=>y(E.target.checked),className:"rounded"}),i.jsx("span",{children:"Show FOV cones"})]}),k&&i.jsxs(i.Fragment,{children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p,onChange:E=>F(E.target.checked),className:"rounded"}),i.jsx("span",{children:"Thermal overlay"})]}),p&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-500",children:"Opacity:"}),i.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:T,onChange:E=>j(parseFloat(E.target.value)),className:"w-20 accent-[#ff6600]"})]})]})]}),i.jsxs("div",{className:"mt-1 text-gray-500",children:[R.length," photos"]}),k&&p&&i.jsx("div",{className:"mt-1 text-[#ff6600] text-[10px]",children:"Click overlay for temp"})]}),S&&i.jsxs("div",{className:"absolute top-4 right-4 bg-[#2d2d2d]/95 backdrop-blur-sm rounded-lg p-4 z-10 text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-[#ff6600]",children:[S.tempF.toFixed(1),"F"]}),i.jsxs("div",{className:"text-sm text-gray-400",children:[S.tempC.toFixed(1),"C"]}),i.jsx("button",{onClick:()=>P(null),className:"mt-2 text-xs text-gray-500 hover:text-white",children:"dismiss"})]})]})}function wa({building:e,isSelected:t,onClick:s}){const n=!e.hasData;return i.jsxs("button",{onClick:s,disabled:n,className:`
        relative rounded-lg border-2 p-3 text-left transition-all font-gravesend
        ${t?"border-[#ff6600] bg-[#ff6600]/10":n?"border-gray-200 bg-gray-50 cursor-not-allowed opacity-60":"border-gray-200 bg-white hover:border-[#ff6600]/50 hover:shadow-md cursor-pointer"}
      `,children:[i.jsx("div",{className:"text-lg font-bold text-black leading-tight",children:e.label}),i.jsx("div",{className:`text-xs mt-1 ${n?"text-gray-400":"text-gray-600"}`,children:e.hasData?`${e.imageCount??0} image${(e.imageCount??0)!==1?"s":""}`:"Survey Pending"})]})}function va({project:e,selectedBuildingId:t,onSelectBuilding:s}){const n=w.useMemo(()=>{const a={};for(const o of e.buildings)a[o.type]||(a[o.type]=[]),a[o.type].push(o);return a},[e.buildings]),r=w.useMemo(()=>Object.keys(n).sort(),[n]);return i.jsxs("div",{className:"h-full flex flex-col bg-white font-gravesend",children:[i.jsxs("div",{className:"p-5 border-b border-gray-200",children:[i.jsx("h1",{className:"text-xl font-bold text-black leading-tight",children:e.name}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:e.location})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:r.map(a=>{const o=n[a],l=e.buildingTypes[a],h=o.length;return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[i.jsxs("h2",{className:"text-sm font-bold text-black uppercase tracking-wide",children:["Type ",a," Buildings"]}),i.jsxs("span",{className:"text-xs text-gray-400",children:["(",h,")"]})]}),l?.description&&i.jsx("p",{className:"text-xs text-gray-400 -mt-2 mb-3",children:l.description}),i.jsx("div",{className:"grid grid-cols-3 gap-2",children:o.map(u=>i.jsx(wa,{building:u,isSelected:t===u.id,onClick:()=>s(u.id)},u.id))})]},a)})}),i.jsx("div",{className:"p-4 border-t border-gray-200",children:i.jsx("p",{className:"text-xs text-gray-400 text-center",children:e.client})})]})}function ja({onAuthenticated:e}){const[t,s]=w.useState(""),[n,r]=w.useState(""),[a,o]=w.useState(!1);w.useEffect(()=>{sessionStorage.getItem("portal_access")==="granted"&&e()},[e]);const l=h=>{h.preventDefault(),r(""),o(!0),setTimeout(()=>{t.trim().toLowerCase()==="demo"?(sessionStorage.setItem("portal_access","granted"),e()):(r("Invalid access code."),o(!1))},500)};return i.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center font-gravesend",children:i.jsxs("div",{className:"w-full max-w-sm p-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-2xl font-bold text-black",children:"AR Drone Ops"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Inspection Portal"})]}),i.jsxs("form",{onSubmit:l,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Access Code"}),i.jsx("input",{type:"text",value:t,onChange:h=>s(h.target.value),required:!0,autoFocus:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent text-black text-center text-lg tracking-widest",placeholder:"Enter code"})]}),n&&i.jsx("p",{className:"text-sm text-red-600 text-center",children:n}),i.jsx("button",{type:"submit",disabled:a||!t.trim(),className:"w-full py-2.5 bg-black text-white font-medium rounded-lg hover:bg-gray-800 disabled:bg-gray-400 transition-colors",children:a?"Verifying...":"Enter"})]}),i.jsx("p",{className:"text-xs text-gray-400 text-center mt-8",children:"Contact AR Drone Ops for access"})]})})}const Sa=w.lazy(()=>Ft(()=>import("./ThreeView-Brc__CjD.js"),__vite__mapDeps([4,1,2]))),Ca=new An({defaultOptions:{queries:{staleTime:300*1e3,refetchOnWindowFocus:!1}}}),ws=[{id:"viewer",label:"Thermal"},{id:"map",label:"Map"},{id:"3d",label:"3D"}];function Na(){const{currentImage:e,isLoading:t,markers:s,setCurrentImage:n}=ye(),r=Os(),[a,o]=w.useState(!0),[l,h]=w.useState(!1),[u,c]=w.useState("viewer"),[d,x]=w.useState(null),[b,f]=w.useState("buildings"),{data:y,isLoading:p,error:F}=Ie({queryKey:["projectConfig"],queryFn:()=>ea()}),{data:T,isLoading:j,error:S}=Ie({queryKey:["images",d],queryFn:()=>zi(),enabled:!!d}),{data:P}=Ie({queryKey:["mapData",d],queryFn:()=>Yi(),enabled:!!d}),{data:_}=Ie({queryKey:["model3D",d],queryFn:()=>Ji(),enabled:!!d}),{data:O}=Ie({queryKey:["orthophoto",d],queryFn:()=>Zi(),enabled:!!d}),R=w.useCallback(g=>{n(null);const D=ta(g);Fi(D),x(g),f("images"),r.invalidateQueries({queryKey:["images"]}),r.invalidateQueries({queryKey:["mapData"]}),r.invalidateQueries({queryKey:["model3D"]}),r.invalidateQueries({queryKey:["orthophoto"]})},[n,r]),v=w.useCallback(()=>{f("buildings"),n(null)},[n]);if(w.useEffect(()=>{e&&window.innerWidth<768&&o(!1)},[e]),p)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-white font-gravesend",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"spinner-light mb-4"}),i.jsx("p",{className:"text-gray-500",children:"Loading project..."})]})});if(F)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-white font-gravesend",children:i.jsxs("div",{className:"text-center p-8",children:[i.jsx("h1",{className:"text-2xl text-red-500 mb-4",children:"Project Load Error"}),i.jsx("p",{className:"text-gray-500 mb-4",children:"Could not load project configuration."}),i.jsx("code",{className:"block mt-4 p-2 bg-gray-100 rounded text-sm text-gray-600",children:String(F)})]})});if(S&&d)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-white font-gravesend",children:i.jsxs("div",{className:"text-center p-8",children:[i.jsx("h1",{className:"text-2xl text-red-500 mb-4",children:"Data Load Error"}),i.jsx("p",{className:"text-gray-500 mb-4",children:"Could not load thermal data for this building."}),i.jsx("button",{onClick:v,className:"mt-4 px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800",children:"Back to Buildings"})]})});const k=y?.buildings.find(g=>g.id===d),E=({tab:g})=>i.jsx("button",{onClick:()=>c(g.id),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-sm font-medium transition-all ${u===g.id?"bg-black text-white":"text-gray-400 hover:text-black hover:bg-gray-100"}`,children:i.jsx("span",{children:g.label})}),C=u==="viewer",L=u==="viewer";return i.jsxs("div",{className:"theme-light flex flex-col md:flex-row h-screen bg-white font-gravesend",children:[i.jsxs("header",{className:"md:hidden h-14 bg-white border-b border-gray-200 flex items-center px-2 justify-between shrink-0 safe-area-bottom",children:[C?i.jsx("button",{onClick:()=>{o(!a),h(!1)},className:`flex items-center gap-1 px-3 py-2 rounded-lg transition-all ${a?"bg-black text-white":"text-black active:bg-gray-100"}`,children:i.jsx("span",{className:"text-sm font-medium",children:b==="buildings"?"Buildings":"Images"})}):i.jsx("div",{className:"w-20"}),i.jsx("div",{className:"flex gap-1",children:ws.map(g=>i.jsx("button",{onClick:()=>c(g.id),className:`px-2.5 py-1.5 rounded-md text-xs font-medium transition-all ${u===g.id?"bg-black text-white":"text-gray-400 active:bg-gray-100"}`,children:i.jsx("span",{children:g.label})},g.id))}),L?i.jsxs("button",{onClick:()=>{h(!l),o(!1)},className:`flex items-center gap-1 px-3 py-2 rounded-lg transition-all ${l?"bg-black text-white":"text-black active:bg-gray-100"}`,children:[i.jsx("span",{className:"text-sm font-medium",children:"Settings"}),s.length>0&&i.jsx("span",{className:"bg-[#ff6600] text-white text-xs px-1.5 py-0.5 rounded-full font-bold ml-1",children:s.length})]}):i.jsx("div",{className:"w-20"})]}),C&&i.jsxs(i.Fragment,{children:[i.jsxs("aside",{className:`${a?"translate-x-0":"-translate-x-full"} md:translate-x-0 fixed md:relative z-30 h-[calc(100%-3.5rem)] md:h-auto top-14 md:top-0 w-72 transition-transform duration-300 ease-out bg-white border-r border-gray-200 overflow-y-auto`,children:[i.jsxs("div",{className:"md:hidden flex justify-between items-center p-3 border-b border-gray-200 sticky top-0 bg-white z-10",children:[i.jsx("span",{className:"font-bold text-black",children:b==="buildings"?"Select Building":k?.label||"Images"}),i.jsx("button",{onClick:()=>o(!1),className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-black bg-gray-100 rounded-full",children:""})]}),b==="buildings"&&y?i.jsx(va,{project:y,selectedBuildingId:d,onSelectBuilding:R}):b==="images"&&d?i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("button",{onClick:v,className:"hidden md:flex items-center gap-2 px-4 py-3 text-sm text-gray-500 hover:text-black hover:bg-gray-50 border-b border-gray-200 transition-colors",children:[i.jsx("span",{children:""}),i.jsx("span",{children:"All Buildings"}),k&&i.jsx("span",{className:"ml-auto text-xs font-medium text-[#ff6600]",children:k.label})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsx(na,{images:T?.images||[],flightGroups:T?.flightGroups||[],photoGroups:T?.photoGroups||[],isLoading:j})})]}):null]}),a&&i.jsx("div",{className:"md:hidden fixed inset-0 bg-black/40 z-20 top-14",onClick:()=>o(!1)}),i.jsx("button",{onClick:()=>o(!a),className:"hidden md:block absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-black hover:bg-gray-800 text-white p-2 rounded-r transition-all",style:{left:a?"288px":"0"},children:a?"":""})]}),i.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[i.jsxs("header",{className:"hidden md:flex h-12 bg-white border-b border-gray-200 items-center px-4 justify-between shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("h1",{className:"text-lg font-bold text-black",children:y?.name||"Thermal Viewer"}),i.jsx("div",{className:"flex gap-1 ml-4",children:ws.map(g=>i.jsx(E,{tab:g},g.id))})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[k&&i.jsx("span",{className:"text-sm font-medium text-[#ff6600]",children:k.label}),e&&i.jsx("span",{className:"text-sm text-gray-400",children:e.filename})]})]}),i.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden min-h-0",children:[u==="viewer"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex-1 relative min-h-[250px] md:min-h-0",children:[e?i.jsx(ha,{}):i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsxs("div",{className:"text-center text-gray-400 p-4",children:[i.jsx("p",{className:"text-xl mb-2",children:d?"Select an image to begin":"Select a building to begin"}),i.jsx("p",{className:"text-sm",children:j?"Loading images...":d?`${T?.totalCount||0} thermal images available`:`${y?.buildings.filter(g=>g.hasData).length||0} buildings with data`}),i.jsx("button",{onClick:()=>o(!0),className:"mt-4 px-4 py-2 bg-black text-white rounded-lg md:hidden",children:d?"Browse Images":"Browse Buildings"})]})}),t&&i.jsx("div",{className:"absolute inset-0 bg-white/60 flex items-center justify-center",children:i.jsx("div",{className:"spinner-light"})})]}),i.jsx("aside",{className:`${l?"max-h-[60vh]":"max-h-0"} md:max-h-none md:w-80 overflow-hidden md:overflow-y-auto transition-all duration-300 ease-out bg-white border-t md:border-t-0 md:border-l border-gray-200`,children:i.jsx("div",{className:"overflow-y-auto max-h-[60vh] md:max-h-none",children:i.jsx(fa,{})})})]}),u==="map"&&i.jsx("div",{className:"flex-1 relative",children:d?i.jsx(ba,{images:T?.images||[],photoGroups:T?.photoGroups||[],mapData:P,orthophoto:O}):i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{className:"text-gray-400",children:"Select a building to view map data"})})}),u==="3d"&&i.jsx("div",{className:"flex-1 relative",children:d?i.jsx(w.Suspense,{fallback:i.jsx("div",{className:"flex items-center justify-center h-full bg-white",children:i.jsxs("div",{className:"text-center text-gray-400",children:[i.jsx("div",{className:"spinner-light mb-4"}),i.jsx("p",{children:"Loading 3D viewer..."})]})}),children:i.jsx(Sa,{images:T?.images||[],photoGroups:T?.photoGroups||[],modelUrl:_?.url,modelTransform:_?.transform,originLat:_?.originLat,originLon:_?.originLon})}):i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{className:"text-gray-400",children:"Select a building to view 3D model"})})})]})]})]})}function Ta(){const[e,t]=w.useState(!1),s=w.useCallback(()=>{t(!0)},[]);return e?i.jsx(Mn,{client:Ca,children:i.jsx(Na,{})}):i.jsx(ja,{onAuthenticated:s})}const Ga=Object.freeze(Object.defineProperty({__proto__:null,default:Ta},Symbol.toStringTag,{value:"Module"}));export{Ga as P,Qn as c,ye as u};
